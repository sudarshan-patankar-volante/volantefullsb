@IsTest(SeeAllData=False)
public class VG_Revise_NordicsProductSteps_Test {
    public static testmethod void testmethod1(){ 
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('Bridge',acc.id);
        Asset__c ass=VG_TU.createAsset(acc.id);
        ass.MID_Notification_Complete__c=true;
        ass.VG_Full_Value_Building__c=56000000;
        update ass;
        pol.CurrencyIsoCode='SEK';
        pol.VG_Expiry_Date__c=Date.newInstance(2018, 12, 18);
        Update pol;
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        ps.VG_MTA_Start_Date__c = Date.newInstance(2017, 6, 18);
        ps.Product__c = 'Property';
        Update ps;
        List<VG_Pricing__c> priceList2=new List<VG_Pricing__c>();
        VG_pricing__c pr21=new VG_pricing__c();
        pr21.Name='Test Data21';
        pr21.VG_product__c='GLPL';
        pr21.VG_Level__c = 'Risk Detail';
        pr21.VG_Rate__c=4.60;
        pr21.VG_Rating_Factor__c='Construction - Surface construction';
        pr21.VG_Category__c = 'Type of operation';
        pr21.VG_Order__c=1;
        priceList2.add(pr21);
        VG_pricing__c pr22=new VG_pricing__c();
        pr22.Name='Test Data22';
        pr22.VG_product__c='Property';
        pr22.VG_Level__c = 'Risk Detail';
        pr22.VG_Rate__c=4.60;
        pr22.VG_Rating_Factor__c='Sport and convention halls - Without restaurant';
        pr22.VG_Category__c = 'BI Base Rate';
        pr22.VG_Order__c=1;
        priceList2.add(pr22);
        VG_pricing__c pr23=new VG_pricing__c();
        pr23.Name='Test Data23';
        pr23.VG_product__c='GLPL';
        pr23.VG_Level__c = 'Risk Detail';
        pr23.VG_Rate__c=4.60;
        pr23.VG_Rating_Factor__c='Construction - Underground construction';
        pr23.VG_Category__c = 'Type of operation';
        pr23.VG_Order__c=1;
        priceList2.add(pr23);
        VG_pricing__c pr4=new VG_pricing__c();
        pr4.Name='Test Data4';
        pr4.VG_product__c='FIPI';
        pr4.VG_Level__c = 'Risk Detail';
        pr4.VG_Rate__c=4.60;
        pr4.VG_Rating_Factor__c='Medium High';
        pr4.VG_Category__c = 'Transactional';
        pr4.VG_Order__c=1;
        priceList2.add(pr4);
        VG_pricing__c pr5=new VG_pricing__c();
        pr5.Name='Test Data5';
        pr5.VG_product__c='FIPI';
        pr5.VG_Level__c = 'Risk Detail';
        pr5.VG_Rate__c=4.60;
        pr5.VG_Rating_Factor__c='Medium';
        pr5.VG_Category__c = 'Transactional';
        pr5.VG_Order__c=1;
        priceList2.add(pr5);
        VG_pricing__c pr6=new VG_pricing__c();
        pr6.Name='Test Data6';
        pr6.VG_product__c='Clinical Trials';
        pr6.VG_Level__c = 'Risk Detail';
        pr6.VG_Rate__c=4.60;
        pr6.VG_Rating_Factor__c='  >250000';
        pr6.VG_Category__c = 'Deductible Adjustment';
        pr6.VG_Order__c=1;
        priceList2.add(pr6);
        VG_pricing__c pr7=new VG_pricing__c();
        pr7.Name='Test Data7';
        pr7.VG_product__c='Property';
        pr7.VG_Level__c = 'Risk Detail';
        pr7.VG_Rate__c=4.60;
        pr7.VG_Rating_Factor__c='Real Estate - Combustable buildings (wood etc)';
        pr7.VG_Category__c = 'PD Base Rate';
        pr7.VG_Order__c=1;
        priceList2.add(pr7);
        VG_pricing__c pr8=new VG_pricing__c();
        pr8.Name='Test Data8';
        pr8.VG_product__c='Property';
        pr8.VG_Level__c = 'Risk Detail';
        pr8.VG_Rate__c=4.60;
        pr8.VG_Rating_Factor__c='Medium low exposure';
        pr8.VG_Category__c = 'Machinery Breakdown Cover';
        pr8.VG_Order__c=1;
        priceList2.add(pr8);
        VG_pricing__c pr9=new VG_pricing__c();
        pr9.Name='Test Data9';
        pr9.VG_product__c='Property';
        pr9.VG_Level__c = 'Risk Detail';
        pr9.VG_Rate__c=4.60;
        pr9.VG_Rating_Factor__c='Medium low exposure';
        pr9.VG_Category__c = 'Machinery Breakdown BI Cover';
        pr9.VG_Order__c=1;
        priceList2.add(pr9);
        VG_pricing__c pr10=new VG_pricing__c();
        pr10.Name='Test Data10';
        pr10.VG_product__c='Property';
        pr10.VG_Level__c = 'Risk Detail';
        pr10.VG_Rate__c=4.60;
        pr10.VG_Rating_Factor__c='50000';
        pr10.VG_Category__c = 'Deductible Adjustment';
        pr10.VG_Order__c=1;
        priceList2.add(pr10);
        VG_pricing__c pr11=new VG_pricing__c();
        pr11.Name='Test Data11';
        pr11.VG_product__c='Property';
        pr11.VG_Level__c = 'Risk Detail';
        pr11.VG_Rate__c=4.60;
        pr11.VG_Rating_Factor__c='80000';
        pr11.VG_Category__c = 'Deductible Adjustment';
        pr11.VG_Order__c=1;
        priceList2.add(pr11);
        VG_pricing__c pr12=new VG_pricing__c();
        pr12.Name='Test Data12';
        pr12.VG_product__c='Property';
        pr12.VG_Level__c = 'Risk Detail';
        pr12.VG_Rate__c=4.60;
        pr12.VG_Rating_Factor__c='Yes';
        pr12.VG_Category__c = 'Inflammable or Explosive';
        pr12.VG_Order__c=1;
        priceList2.add(pr12);
        VG_pricing__c pr13=new VG_pricing__c();
        pr13.Name='Test Data13';
        pr13.VG_product__c='Property';
        pr13.VG_Level__c = 'Risk Detail';
        pr13.VG_Rate__c=4.60;
        pr13.VG_Rating_Factor__c='Yes';
        pr13.VG_Category__c = 'Pressure over 200 bar and/or temperature over 500 ºC';
        pr13.VG_Order__c=1;
        priceList2.add(pr13);
        VG_pricing__c pr14=new VG_pricing__c();
        pr14.Name='Test Data14';
        pr14.VG_product__c='Property';
        pr14.VG_Level__c = 'Risk Rating';
        pr14.VG_Rate__c=0.03;
        pr14.VG_Rating_Factor__c='250000';
        pr14.VG_Category__c = 'Deductible Adjustment';
        pr14.VG_Order__c=1;
        priceList2.add(pr14);
        VG_pricing__c pr15=new VG_pricing__c();
        pr15.Name='Test Data15';
        pr15.VG_product__c='Property';
        pr15.VG_Level__c = 'Risk Rating';
        pr15.VG_Rate__c=0.07;
        pr15.VG_Rating_Factor__c='1250000';
        pr15.VG_Category__c = 'Deductible Adjustment';
        pr15.VG_Order__c=1;
        priceList2.add(pr15);
        Insert priceList2;
        List<VG_Exposure_Premium__c> expList=new List<VG_Exposure_Premium__c>();
        VG_Exposure_Premium__c exp1 =new VG_Exposure_Premium__c();
        exp1.VG_Factor_Name__c='Hazardous Activity';
        exp1.VG_Other_Factor__c=false;
        exp1.VG_Policy_Schedule__c=ps.id;
        exp1.VG_Rate__c=0.8000;
        exp1.VG_Rating_Factor__c='0.80>Low';
        expList.add(exp1);
        VG_Exposure_Premium__c exp2 =new VG_Exposure_Premium__c();
        exp2.VG_Factor_Name__c='Hazardous Product';
        exp2.VG_Other_Factor__c=false;
        exp2.VG_Policy_Schedule__c=ps.id;
        exp2.VG_Rate__c=1.0000;
        exp2.VG_Rating_Factor__c='1.00>Medium Low';
        expList.add(exp2);
        VG_Exposure_Premium__c exp3 =new VG_Exposure_Premium__c();
        exp3.VG_Factor_Name__c='Risk Management';
        exp3.VG_Other_Factor__c=false;
        exp3.VG_Policy_Schedule__c=ps.id;
        exp3.VG_Rate__c=1.0000;
        exp3.VG_Rating_Factor__c='1.00>Medium Level';
        expList.add(exp3);
        VG_Exposure_Premium__c exp4 =new VG_Exposure_Premium__c();
        exp4.VG_Factor_Name__c='US Exports (% of Total)';
        exp4.VG_Other_Factor__c=false;
        exp4.VG_Policy_Schedule__c=ps.id;
        exp4.VG_Rate__c=1.6000;
        exp4.VG_Rating_Factor__c='1.60>0% - 5%';
        expList.add(exp4);
        VG_Exposure_Premium__c exp5 =new VG_Exposure_Premium__c();
        exp5.VG_Factor_Name__c='US Domiciled (% of Total)';
        exp5.VG_Other_Factor__c=false;
        exp5.VG_Policy_Schedule__c=ps.id;
        exp5.VG_Rate__c=1.0000;
        exp5.VG_Rating_Factor__c='1.00>0';
        expList.add(exp5);
        VG_Exposure_Premium__c exp6 =new VG_Exposure_Premium__c();
        exp6.VG_Factor_Name__c='null';
        exp6.VG_Other_Factor__c=true;
        exp6.VG_Policy_Schedule__c=ps.id;
        exp6.VG_Rate__c=0.0000;
        exp6.VG_Rating_Factor__c='null';
        expList.add(exp6);
        VG_Exposure_Premium__c exp7 =new VG_Exposure_Premium__c();
        exp7.VG_Factor_Name__c='null';
        exp7.VG_Other_Factor__c=true;
        exp7.VG_Policy_Schedule__c=ps.id;
        exp7.VG_Rate__c=0.0000;
        exp7.VG_Rating_Factor__c='null';
        expList.add(exp7);
        VG_Exposure_Premium__c exp8 =new VG_Exposure_Premium__c();
        exp8.VG_Factor_Name__c='null';
        exp8.VG_Other_Factor__c=true;
        exp8.VG_Policy_Schedule__c=ps.id;
        exp8.VG_Rate__c=0.0000;
        exp8.VG_Rating_Factor__c='null';
        expList.add(exp8);
        VG_Exposure_Premium__c exp9 =new VG_Exposure_Premium__c();
        exp9.VG_Factor_Name__c='Hazardous Activity';
        exp9.VG_Other_Factor__c=false;
        exp9.VG_Policy_Schedule__c=ps.id;
        exp9.VG_Rate__c=0.8000;
        exp9.VG_Rating_Factor__c='0.80>Low';
        expList.add(exp9);
        VG_Exposure_Premium__c exp10 =new VG_Exposure_Premium__c();
        exp10.VG_Factor_Name__c='Hazardous Product';
        exp10.VG_Other_Factor__c=false;
        exp10.VG_Policy_Schedule__c=ps.id;
        exp10.VG_Rate__c=1.0000;
        exp10.VG_Rating_Factor__c='1.00>Medium Low';
        expList.add(exp10);
        VG_Exposure_Premium__c exp11 =new VG_Exposure_Premium__c();
        exp11.VG_Factor_Name__c='Risk Management';
        exp11.VG_Other_Factor__c=false;
        exp11.VG_Policy_Schedule__c=ps.id;
        exp11.VG_Rate__c=1.0000;
        exp11.VG_Rating_Factor__c='1.00>Medium Level';
        expList.add(exp11);
        VG_Exposure_Premium__c exp12 =new VG_Exposure_Premium__c();
        exp12.VG_Factor_Name__c='US Exports (% of Total)';
        exp12.VG_Other_Factor__c=false;
        exp12.VG_Policy_Schedule__c=ps.id;
        exp12.VG_Rate__c=1.6000;
        exp12.VG_Rating_Factor__c='1.60>0% - 5%';
        expList.add(exp12);
        VG_Exposure_Premium__c exp13 =new VG_Exposure_Premium__c();
        exp13.VG_Factor_Name__c='US Domiciled (% of Total)';
        exp13.VG_Other_Factor__c=false;
        exp13.VG_Policy_Schedule__c=ps.id;
        exp13.VG_Rate__c=1.0000;
        exp13.VG_Rating_Factor__c='1.00>0';
        expList.add(exp13);
        VG_Exposure_Premium__c exp14 =new VG_Exposure_Premium__c();
        exp14.VG_Factor_Name__c='null';
        exp14.VG_Other_Factor__c=true;
        exp14.VG_Policy_Schedule__c=ps.id;
        exp14.VG_Rate__c=0.0000;
        exp14.VG_Rating_Factor__c='null';
        expList.add(exp14);
        VG_Exposure_Premium__c exp15 =new VG_Exposure_Premium__c();
        exp15.VG_Factor_Name__c='null';
        exp15.VG_Other_Factor__c=true;
        exp15.VG_Policy_Schedule__c=ps.id;
        exp15.VG_Rate__c=0.0000;
        exp15.VG_Rating_Factor__c='null';
        expList.add(exp15);
        VG_Exposure_Premium__c exp16 =new VG_Exposure_Premium__c();
        exp16.VG_Factor_Name__c='null';
        exp16.VG_Other_Factor__c=true;
        exp16.VG_Policy_Schedule__c=ps.id;
        exp16.VG_Rate__c=0.0000;
        exp16.VG_Rating_Factor__c='null';
        expList.add(exp16);
        Insert expList;
        List<VG_Pricing__c> priceList=new List<VG_Pricing__c>();
        VG_Pricing__c pr=new VG_Pricing__c();
        pr.Name='prTest1';
        pr.VG_Product__c='GLPL';
        pr.VG_Level__c = 'Risk Detail';
        pr.VG_Rate__c=1000;
        pr.VG_Rating_Factor__c='Agentur';
        pr.VG_Category__c = 'Type of operation';
        pr.VG_Order__c=1;
        priceList.add(pr);
        VG_Pricing__c pr3=pr.clone(false,true,false,false);
        priceList.add(pr3);
        VG_Pricing__c pr1=new VG_Pricing__c();
        pr1.Name='prTest2';
        pr1.VG_Product__c='GLPL';
        pr1.VG_Level__c = 'Risk Detail';
        pr1.VG_Rate__c=1000;
        pr1.VG_Rating_Factor__c='Agentur';
        pr1.VG_Category__c = 'Deductible Adjustment';
        pr1.VG_Order__c=1;
        priceList.add(pr1);
        VG_Pricing__c pr2=new VG_Pricing__c();
        pr2.Name='prTest3';
        pr2.VG_Product__c='Property';
        pr2.VG_Level__c = 'Risk Detail';
        pr2.VG_Rate__c=1000;
        pr2.VG_Rating_Factor__c='Agentur';
        pr2.VG_Category__c = 'Deductible Adjustment';
        pr2.VG_Order__c=1;
        priceList.add(pr2);
        Insert priceList;
        Endorsement_Library__c el=VG_TU.createEndorsementLibrary();
        el.RecordTypeId=Schema.SObjectType.Endorsement_Library__c.getRecordTypeInfosByName().get('Bridge').getRecordTypeId();
        Update el;
        Endorsement_Library__c el1=el.clone(false,true,false,false);
        el1.Type__c='Sub-limits';
        Insert el1;
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);
        pse.VG_Endorsement_Library_Id__c=el.id;
        update pse;
        VG_Policy_Schedule_Asset__c psa=VG_TU.createPolicyScheduleAsset(ps.id);
        VG_Policy_Schedule_Asset__c psa1=psa.clone(false,true,false,false);
        ApexPages.currentPage().getParameters().put('PSId', ps.id);
        ApexPages.currentPage().getParameters().put('Currency', pol.CurrencyIsoCode);
        VG_Revise_NordicsProductSteps cntr = new VG_Revise_NordicsProductSteps();
        VG_Revise_NordicsProductSteps.RRWrapper rrw=new VG_Revise_NordicsProductSteps.RRWrapper();
        VG_Revise_NordicsProductSteps.LibraryWrapper lw=new VG_Revise_NordicsProductSteps.LibraryWrapper();
        cntr.DeductibleRate_Converted=2000;
        cntr.techLayerPremium =2000;
        cntr.sharePercent=20;
        cntr.adjustment=2000;
        cntr.Turnover_Converted=20000;
        cntr.pricingRate='20000';
        cntr.experiencePremium_Converted=2000;
        cntr.seletedWeight=200;
        cntr.netExposurePremium=2000;
        RRW.psa = psa;
        RRW.counter = '0';
        RRW.share=100;
        cntr.PDBaseRate=2.3;
        cntr.adjustmentFactor=25.3;
        cntr.cancel();//completed
        cntr.gotostep1A();//completed
        cntr.gotostep2();
        cntr.price=pr2;
        cntr.PDBaseRate=2.3;
        cntr.adjustmentFactor=25.3;
        cntr.gotostep2();
        cntr.gotostep3();//completed 
        el.VG_Product__c=cntr.price.VG_Product__c;
        update el;
        cntr.gotostep4();
        cntr.gotostep6();
        //cntr.LibraryWrapperList[0].IsSelected=false;
        //cntr.LibraryWrapperList1[0].IsSelected=false;
        cntr.gotostep4b();
        cntr.gotostep6b();
        cntr.AddCustom();
        VG_Policy_Schedule_Endorsement__c tempEndsmt = new VG_Policy_Schedule_Endorsement__c();
        tempEndsmt.CurrencyISOCode = 'USD';
        tempEndsmt.VG_Endorsement_Library_Id__c=el.id;
        tempEndsmt.VG_Premium__c = 1000;
        tempEndsmt.VG_Sub_limit__c=1000;
        cntr.existingEndorsements1.add(tempEndsmt);
        cntr.existingEndorsements[0].VG_Premium__c =1000;
        cntr.existingEndorsements[0].VG_Sub_limit__c =1000;
        //cntr.LibraryWrapperList[0].IsSelected=True;
        //cntr.LibraryWrapperList1[0].IsSelected=True;
        cntr.gotostep4b();
        cntr.gotostep6b();
        cntr.gotostep5();//completed
        cntr.addRR();//completed
        cntr.AddCustom();//completed
        cntr.Index='0';
        cntr.counter=0;
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.RemoveAsset();//completed
        cntr.CancelAsset();//completed
        cntr.EditAsset();//completed
        cntr.setLPList();
        cntr.price.VG_Product__c='Commercial';
        cntr.setLPList();
        cntr.gotostep4();
        cntr.gotostep6();
        //cntr.riskRatingList.add(RRW);
        cntr.IsProperty=false;
        cntr.gotostep4();
        cntr.gotostep6();
        cntr.price.VG_Product__c='GLPL';
        cntr.setLPList();
        cntr.price.VG_Product__c='Life Sciences';
        cntr.setLPList();
        cntr.price.VG_Product__c='D&O';
        cntr.setLPList();
        cntr.price.VG_Product__c='Clinical Trials';
        cntr.setLPList();
        cntr.price.VG_Product__c='Crime';
        cntr.setLPList();
        cntr.price.VG_Product__c='FIPI';
        cntr.setLPList();
        cntr.price.VG_Product__c='PI';
        cntr.setLPList();//completed
        //cntr.finish();
        cntr.existingEndorsements.add(tempEndsmt);
        cntr.existingEndorsements1.add(tempEndsmt.clone(false,true,false,false));
        VG_Revise_NordicsProductSteps.AssetWrapper aw=new VG_Revise_NordicsProductSteps.AssetWrapper();
        aw.asset=psa.clone(false,true,false,false);
        aw.Name='test';
        aw.totalPropertyDamageSI=2000;
        aw.totalBusinessInterruptionSI=200;
        aw.totalSumInsuredSI=2000;
        aw.totalSumInsuredMBSI=2000;
        aw.fullValue=2000;
        aw.PDDeductibleAmount=2000;
        aw.PDDeductible=2000;
        aw.WaitingPeriod=2000;
        aw.BIIndemnityPeriod=200;
        aw.MBPDDeductibleAmount=2000;
        aw.MBPDDeductible=2000;
        aw.MBWaitingPeriod=2000;
        aw.MBBIIndemnityPeriod=2000;
        aw.AdjustedPDPremium=2000;
        aw.AdjustedMBPremium=2000;
        aw.AdjustedBIPremium=20000;
        aw.AutomaticFirealarm=2000;
        aw.WaterSprinklers=2000;
        aw.FoamSupressionSystem=2000;
        aw.SmokeAndHeatVentingSystem=2000;
        aw.FulltimePublicFireBrigadeStaff=2000;
        aw.TotalDiscountLoading=2000;
        aw.NetPDPremium=2000;
        aw.NetBIPremium=2000;
        aw.NetRiskPremium=2000;
        cntr.assetList.add(aw);
        cntr.IsProperty=true;
        cntr.ps.id=null;
        Test.StartTest();
        cntr.finish();
        cntr.IsProperty=false;
        VG_Revise_NordicsProductSteps.PricingWrapper pw=new VG_Revise_NordicsProductSteps.PricingWrapper();
        pw.FactorName='Deductible';
        pw.factors.add(new SelectOption('2000>20000','2000>20000'));
        pw.price='2000.0';
        pw.order=1;
        pw.selectedFactor='';
        pw.productName='GLPL';
        pw.premiumMovement=2000;
        pw.premiumMovement_Converted=2000;
        pw.priceDecimal=2000;
        cntr.deductibleFactor=pw;
        cntr.attachment_Converted=2000000;
        cntr.limitAmount_Converted=200000;
        cntr.UpdateFinalCalculations();
        cntr.layer='Primary';
        cntr.UpdateFinalCalculations();
        cntr.Turnover_Converted=20000;
        cntr.updateExposure();
        cntr.UpdateAssetPremium();
        Test.StopTest();
    }
    
    
    public static testmethod void testmethod2(){
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Utilities.SkipMethods('Bridge Context');
        Policy__c pol=VG_TU.createPolicy('Bridge',acc.id);
        Asset__c ass=VG_TU.createAsset(acc.id);
        ass.MID_Notification_Complete__c=true;
        ass.VG_Full_Value_Building__c=56000000;
        update ass;
        pol.CurrencyIsoCode='SEK';
        pol.VG_Expiry_Date__c=Date.newInstance(2019, 6, 18);
        Update pol;
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        ps.Product__c='Property';
        ps.Limit__c=20000;
        ps.Attachment__c=2000000;
        ps.Sum_Insured__c=20000;
        ps.VG_Brokerage_Percent__c=20;
        ps.VG_Net_Base_Premium__c =20000;
        ps.Gross_Base_Premium__c=25000;
        ps.VG_MTA_End_Date__c = Date.newInstance(2019, 6, 18);
        update ps;
        List<VG_Pricing__c> priceList2=new List<VG_Pricing__c>();
        VG_pricing__c pr21=new VG_pricing__c();
        pr21.Name='Test Data21';
        pr21.VG_product__c='GLPL';
        pr21.VG_Level__c = 'Risk Detail';
        pr21.VG_Rate__c=4.60;
        pr21.VG_Rating_Factor__c='Construction - Surface construction';
        pr21.VG_Category__c = 'Type of operation';
        pr21.VG_Order__c=1;
        priceList2.add(pr21);
        VG_pricing__c pr22=new VG_pricing__c();
        pr22.Name='Test Data22';
        pr22.VG_product__c='Property';
        pr22.VG_Level__c = 'Risk Detail';
        pr22.VG_Rate__c=4.60;
        pr22.VG_Rating_Factor__c='Sport and convention halls - Without restaurant';
        pr22.VG_Category__c = 'BI Base Rate';
        pr22.VG_Order__c=1;
        priceList2.add(pr22);
        VG_pricing__c pr23=new VG_pricing__c();
        pr23.Name='Test Data23';
        pr23.VG_product__c='GLPL';
        pr23.VG_Level__c = 'Risk Detail';
        pr23.VG_Rate__c=4.60;
        pr23.VG_Rating_Factor__c='Construction - Underground construction';
        pr23.VG_Category__c = 'Type of operation';
        pr23.VG_Order__c=1;
        priceList2.add(pr23);
        VG_pricing__c pr4=new VG_pricing__c();
        pr4.Name='Test Data4';
        pr4.VG_product__c='FIPI';
        pr4.VG_Level__c = 'Risk Detail';
        pr4.VG_Rate__c=4.60;
        pr4.VG_Rating_Factor__c='Medium High';
        pr4.VG_Category__c = 'Transactional';
        pr4.VG_Order__c=1;
        priceList2.add(pr4);
        VG_pricing__c pr5=new VG_pricing__c();
        pr5.Name='Test Data5';
        pr5.VG_product__c='FIPI';
        pr5.VG_Level__c = 'Risk Detail';
        pr5.VG_Rate__c=4.60;
        pr5.VG_Rating_Factor__c='Medium';
        pr5.VG_Category__c = 'Transactional';
        pr5.VG_Order__c=1;
        priceList2.add(pr5);
        VG_pricing__c pr6=new VG_pricing__c();
        pr6.Name='Test Data6';
        pr6.VG_product__c='Clinical Trials';
        pr6.VG_Level__c = 'Risk Detail';
        pr6.VG_Rate__c=4.60;
        pr6.VG_Rating_Factor__c='  >250000';
        pr6.VG_Category__c = 'Deductible Adjustment';
        pr6.VG_Order__c=1;
        priceList2.add(pr6);
        VG_pricing__c pr7=new VG_pricing__c();
        pr7.Name='Test Data7';
        pr7.VG_product__c='Property';
        pr7.VG_Level__c = 'Risk Detail';
        pr7.VG_Rate__c=4.60;
        pr7.VG_Rating_Factor__c='Real Estate - Combustable buildings (wood etc)';
        pr7.VG_Category__c = 'PD Base Rate';
        pr7.VG_Order__c=1;
        priceList2.add(pr7);
        VG_pricing__c pr8=new VG_pricing__c();
        pr8.Name='Test Data8';
        pr8.VG_product__c='Property';
        pr8.VG_Level__c = 'Risk Detail';
        pr8.VG_Rate__c=4.60;
        pr8.VG_Rating_Factor__c='Medium low exposure';
        pr8.VG_Category__c = 'Machinery Breakdown Cover';
        pr8.VG_Order__c=1;
        priceList2.add(pr8);
        VG_pricing__c pr9=new VG_pricing__c();
        pr9.Name='Test Data9';
        pr9.VG_product__c='Property';
        pr9.VG_Level__c = 'Risk Detail';
        pr9.VG_Rate__c=4.60;
        pr9.VG_Rating_Factor__c='Medium low exposure';
        pr9.VG_Category__c = 'Machinery Breakdown BI Cover';
        pr9.VG_Order__c=1;
        priceList2.add(pr9);
        VG_pricing__c pr10=new VG_pricing__c();
        pr10.Name='Test Data10';
        pr10.VG_product__c='Property';
        pr10.VG_Level__c = 'Risk Detail';
        pr10.VG_Rate__c=4.60;
        pr10.VG_Rating_Factor__c='50000';
        pr10.VG_Category__c = 'Deductible Adjustment';
        pr10.VG_Order__c=1;
        priceList2.add(pr10);
        VG_pricing__c pr11=new VG_pricing__c();
        pr11.Name='Test Data11';
        pr11.VG_product__c='Property';
        pr11.VG_Level__c = 'Risk Detail';
        pr11.VG_Rate__c=4.60;
        pr11.VG_Rating_Factor__c='80000';
        pr11.VG_Category__c = 'Deductible Adjustment';
        pr11.VG_Order__c=1;
        priceList2.add(pr11);
        VG_pricing__c pr12=new VG_pricing__c();
        pr12.Name='Test Data12';
        pr12.VG_product__c='Property';
        pr12.VG_Level__c = 'Risk Detail';
        pr12.VG_Rate__c=4.60;
        pr12.VG_Rating_Factor__c='Yes';
        pr12.VG_Category__c = 'Inflammable or Explosive';
        pr12.VG_Order__c=1;
        priceList2.add(pr12);
        VG_pricing__c pr13=new VG_pricing__c();
        pr13.Name='Test Data13';
        pr13.VG_product__c='Property';
        pr13.VG_Level__c = 'Risk Detail';
        pr13.VG_Rate__c=4.60;
        pr13.VG_Rating_Factor__c='Yes';
        pr13.VG_Category__c = 'Pressure over 200 bar and/or temperature over 500 ºC';
        pr13.VG_Order__c=1;
        priceList2.add(pr13);
        VG_pricing__c pr14=new VG_pricing__c();
        pr14.Name='Test Data14';
        pr14.VG_product__c='Property';
        pr14.VG_Level__c = 'Risk Rating';
        pr14.VG_Rate__c=0.03;
        pr14.VG_Rating_Factor__c='250000';
        pr14.VG_Category__c = 'Deductible Adjustment';
        pr14.VG_Order__c=1;
        priceList2.add(pr14);
        VG_pricing__c pr15=new VG_pricing__c();
        pr15.Name='Test Data15';
        pr15.VG_product__c='Property';
        pr15.VG_Level__c = 'Risk Rating';
        pr15.VG_Rate__c=0.07;
        pr15.VG_Rating_Factor__c='1250000';
        pr15.VG_Category__c = 'Deductible Adjustment';
        pr15.VG_Order__c=1;
        priceList2.add(pr15);
        Insert priceList2;
        List<VG_Exposure_Premium__c> expList=new List<VG_Exposure_Premium__c>();
        VG_Exposure_Premium__c exp1 =new VG_Exposure_Premium__c();
        exp1.VG_Factor_Name__c='Hazardous Activity';
        exp1.VG_Other_Factor__c=false;
        exp1.VG_Policy_Schedule__c=ps.id;
        exp1.VG_Rate__c=0.8000;
        exp1.VG_Rating_Factor__c='0.80>Low';
        expList.add(exp1);
        VG_Exposure_Premium__c exp2 =new VG_Exposure_Premium__c();
        exp2.VG_Factor_Name__c='Hazardous Product';
        exp2.VG_Other_Factor__c=false;
        exp2.VG_Policy_Schedule__c=ps.id;
        exp2.VG_Rate__c=1.0000;
        exp2.VG_Rating_Factor__c='1.00>Medium Low';
        expList.add(exp2);
        VG_Exposure_Premium__c exp3 =new VG_Exposure_Premium__c();
        exp3.VG_Factor_Name__c='Risk Management';
        exp3.VG_Other_Factor__c=false;
        exp3.VG_Policy_Schedule__c=ps.id;
        exp3.VG_Rate__c=1.0000;
        exp3.VG_Rating_Factor__c='1.00>Medium Level';
        expList.add(exp3);
        VG_Exposure_Premium__c exp4 =new VG_Exposure_Premium__c();
        exp4.VG_Factor_Name__c='US Exports (% of Total)';
        exp4.VG_Other_Factor__c=false;
        exp4.VG_Policy_Schedule__c=ps.id;
        exp4.VG_Rate__c=1.6000;
        exp4.VG_Rating_Factor__c='1.60>0% - 5%';
        expList.add(exp4);
        VG_Exposure_Premium__c exp5 =new VG_Exposure_Premium__c();
        exp5.VG_Factor_Name__c='US Domiciled (% of Total)';
        exp5.VG_Other_Factor__c=false;
        exp5.VG_Policy_Schedule__c=ps.id;
        exp5.VG_Rate__c=1.0000;
        exp5.VG_Rating_Factor__c='1.00>0';
        expList.add(exp5);
        VG_Exposure_Premium__c exp6 =new VG_Exposure_Premium__c();
        exp6.VG_Factor_Name__c='null';
        exp6.VG_Other_Factor__c=true;
        exp6.VG_Policy_Schedule__c=ps.id;
        exp6.VG_Rate__c=0.0000;
        exp6.VG_Rating_Factor__c='null';
        expList.add(exp6);
        VG_Exposure_Premium__c exp7 =new VG_Exposure_Premium__c();
        exp7.VG_Factor_Name__c='null';
        exp7.VG_Other_Factor__c=true;
        exp7.VG_Policy_Schedule__c=ps.id;
        exp7.VG_Rate__c=0.0000;
        exp7.VG_Rating_Factor__c='null';
        expList.add(exp7);
        VG_Exposure_Premium__c exp8 =new VG_Exposure_Premium__c();
        exp8.VG_Factor_Name__c='null';
        exp8.VG_Other_Factor__c=true;
        exp8.VG_Policy_Schedule__c=ps.id;
        exp8.VG_Rate__c=0.0000;
        exp8.VG_Rating_Factor__c='null';
        expList.add(exp8);
        VG_Exposure_Premium__c exp9 =new VG_Exposure_Premium__c();
        exp9.VG_Factor_Name__c='Hazardous Activity';
        exp9.VG_Other_Factor__c=false;
        exp9.VG_Policy_Schedule__c=ps.id;
        exp9.VG_Rate__c=0.8000;
        exp9.VG_Rating_Factor__c='0.80>Low';
        expList.add(exp9);
        VG_Exposure_Premium__c exp10 =new VG_Exposure_Premium__c();
        exp10.VG_Factor_Name__c='Hazardous Product';
        exp10.VG_Other_Factor__c=false;
        exp10.VG_Policy_Schedule__c=ps.id;
        exp10.VG_Rate__c=1.0000;
        exp10.VG_Rating_Factor__c='1.00>Medium Low';
        expList.add(exp10);
        VG_Exposure_Premium__c exp11 =new VG_Exposure_Premium__c();
        exp11.VG_Factor_Name__c='Risk Management';
        exp11.VG_Other_Factor__c=false;
        exp11.VG_Policy_Schedule__c=ps.id;
        exp11.VG_Rate__c=1.0000;
        exp11.VG_Rating_Factor__c='1.00>Medium Level';
        expList.add(exp11);
        VG_Exposure_Premium__c exp12 =new VG_Exposure_Premium__c();
        exp12.VG_Factor_Name__c='US Exports (% of Total)';
        exp12.VG_Other_Factor__c=false;
        exp12.VG_Policy_Schedule__c=ps.id;
        exp12.VG_Rate__c=1.6000;
        exp12.VG_Rating_Factor__c='1.60>0% - 5%';
        expList.add(exp12);
        VG_Exposure_Premium__c exp13 =new VG_Exposure_Premium__c();
        exp13.VG_Factor_Name__c='US Domiciled (% of Total)';
        exp13.VG_Other_Factor__c=false;
        exp13.VG_Policy_Schedule__c=ps.id;
        exp13.VG_Rate__c=1.0000;
        exp13.VG_Rating_Factor__c='1.00>0';
        expList.add(exp13);
        VG_Exposure_Premium__c exp14 =new VG_Exposure_Premium__c();
        exp14.VG_Factor_Name__c='null';
        exp14.VG_Other_Factor__c=true;
        exp14.VG_Policy_Schedule__c=ps.id;
        exp14.VG_Rate__c=0.0000;
        exp14.VG_Rating_Factor__c='null';
        expList.add(exp14);
        VG_Exposure_Premium__c exp15 =new VG_Exposure_Premium__c();
        exp15.VG_Factor_Name__c='null';
        exp15.VG_Other_Factor__c=true;
        exp15.VG_Policy_Schedule__c=ps.id;
        exp15.VG_Rate__c=0.0000;
        exp15.VG_Rating_Factor__c='null';
        expList.add(exp15);
        VG_Exposure_Premium__c exp16 =new VG_Exposure_Premium__c();
        exp16.VG_Factor_Name__c='null';
        exp16.VG_Other_Factor__c=true;
        exp16.VG_Policy_Schedule__c=ps.id;
        exp16.VG_Rate__c=0.0000;
        exp16.VG_Rating_Factor__c='null';
        expList.add(exp16);
        Insert expList;
        List<VG_Pricing__c> priceList=new List<VG_Pricing__c>();
        VG_Pricing__c pr=new VG_Pricing__c();
        pr.Name='prTest1';
        pr.VG_Product__c='GLPL';
        pr.VG_Level__c = 'Risk Detail';
        pr.VG_Rate__c=1000;
        pr.VG_Rating_Factor__c='Agentur';
        pr.VG_Category__c = 'Type of operation';
        pr.VG_Order__c=1;
        priceList.add(pr);
        VG_Pricing__c pr3=pr.clone(false,true,false,false);
        priceList.add(pr3);
        VG_Pricing__c pr1=new VG_Pricing__c();
        pr1.Name='prTest2';
        pr1.VG_Product__c='GLPL';
        pr1.VG_Level__c = 'Risk Detail';
        pr1.VG_Rate__c=1000;
        pr1.VG_Rating_Factor__c='Agentur';
        pr1.VG_Category__c = 'Deductible Adjustment';
        pr1.VG_Order__c=1;
        priceList.add(pr1);
        VG_Pricing__c pr2=new VG_Pricing__c();
        pr2.Name='prTest3';
        pr2.VG_Product__c='Property';
        pr2.VG_Level__c = 'Risk Detail';
        pr2.VG_Rate__c=1000;
        pr2.VG_Rating_Factor__c='Agentur';
        pr2.VG_Category__c = 'Deductible Adjustment';
        pr2.VG_Order__c=1;
        priceList.add(pr2);
        Insert priceList;
        Endorsement_Library__c el=VG_TU.createEndorsementLibrary();
        el.RecordTypeId=Schema.SObjectType.Endorsement_Library__c.getRecordTypeInfosByName().get('Bridge').getRecordTypeId();
        Update el;
        Endorsement_Library__c el1=el.clone(false,true,false,false);
        el1.Type__c='Sub-limits';
        Insert el1;
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);
        pse.VG_Endorsement_Library_Id__c=el.id;
        update pse;
        VG_Policy_Schedule_Asset__c psa=VG_TU.createPolicyScheduleAsset(ps.id);
        VG_Policy_Schedule_Asset__c psa1=psa.clone(false,true,false,false);
        ApexPages.currentPage().getParameters().put('PSId', ps.id);
        ApexPages.currentPage().getParameters().put('policyId', pol.id);
        ApexPages.currentPage().getParameters().put('policyCurrency', 'USD');
        ApexPages.currentPage().getParameters().put('MTAType', 'Extension');
        VG_Revise_NordicsProductSteps cntr = new VG_Revise_NordicsProductSteps();
        VG_Revise_NordicsProductSteps.RRWrapper rrw=new VG_Revise_NordicsProductSteps.RRWrapper();
        VG_Revise_NordicsProductSteps.LibraryWrapper lw=new VG_Revise_NordicsProductSteps.LibraryWrapper();
        cntr.DeductibleRate_Converted=2000;
        cntr.techLayerPremium =2000;
        cntr.sharePercent=20;
        cntr.adjustment=2000;
        cntr.Turnover_Converted=20000;
        cntr.pricingRate='20000';
        cntr.experiencePremium_Converted=2000;
        cntr.seletedWeight=200;
        cntr.netExposurePremium=2000;
        RRW.psa = psa1;
        RRW.counter = '0';
        RRW.share=0;
        cntr.cancel();//completed
        cntr.gotostep1A();//completed
        cntr.price=pr2;
        cntr.gotostep3();//completed 
        el.VG_Product__c=cntr.price.VG_Product__c;
        update el;
        //cntr.LibraryWrapperList[0].IsSelected=false;
        //cntr.LibraryWrapperList1[0].IsSelected=false;
        cntr.gotostep4b();
        cntr.gotostep6b();
        cntr.AddCustom();
        VG_Policy_Schedule_Endorsement__c tempEndsmt = new VG_Policy_Schedule_Endorsement__c();
        tempEndsmt.CurrencyISOCode = 'USD';
        tempEndsmt.VG_Endorsement_Library_Id__c=el.id;
        tempEndsmt.VG_Premium__c = 1000;
        tempEndsmt.VG_Sub_limit__c=1000;
        cntr.existingEndorsements1.add(tempEndsmt);
        cntr.existingEndorsements[0].VG_Premium__c =1000;
        cntr.existingEndorsements[0].VG_Sub_limit__c =1000;
        //cntr.LibraryWrapperList[0].IsSelected=True;
        //cntr.LibraryWrapperList1[0].IsSelected=True;
        cntr.gotostep4();
        cntr.gotostep6();
        cntr.gotostep4b();
        cntr.gotostep6b();
        cntr.gotostep5();//completed
        cntr.addRR();//completed
        cntr.AddCustom();//completed
        cntr.Index='0';
        cntr.counter=0;
        cntr.RemoveRR();//completed
        //cntr.RemoveRR();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.RemoveAsset();//completed
        cntr.CancelAsset();//completed
        cntr.EditAsset();//completed
        cntr.setLPList();
        cntr.price.VG_Product__c='Commercial';
        cntr.setLPList();
        cntr.gotostep4();
        cntr.gotostep6();
        cntr.riskRatingList.add(RRW);
        cntr.IsProperty=false;
        cntr.gotostep4();
        cntr.gotostep6();
        cntr.price.VG_Product__c='GLPL';
        cntr.setLPList();
        cntr.price.VG_Product__c='Life Sciences';
        cntr.setLPList();
        cntr.price.VG_Product__c='D&O';
        cntr.setLPList();
        cntr.price.VG_Product__c='Clinical Trials';
        cntr.setLPList();
        cntr.price.VG_Product__c='Crime';
        cntr.setLPList();
        cntr.price.VG_Product__c='FIPI';
        cntr.setLPList();
        cntr.price.VG_Product__c='PI';
        cntr.setLPList();//completed
        //cntr.pol.VG_Expiry_Date__c=Date.newInstance(2019, 6, 18);
        cntr.ps.VG_MTA_End_Date__c = Date.newInstance(2019, 6, 18);
        Test.StartTest();
        cntr.finish();
        cntr.existingEndorsements.add(tempEndsmt);
        cntr.existingEndorsements1.add(tempEndsmt.clone(false,true,false,false));
        VG_Revise_NordicsProductSteps.AssetWrapper aw=new VG_Revise_NordicsProductSteps.AssetWrapper();
        aw.asset=psa.clone(false,true,false,false);
        aw.Name='test';
        aw.totalPropertyDamageSI=2000;
        aw.totalBusinessInterruptionSI=200;
        aw.totalSumInsuredSI=2000;
        aw.totalSumInsuredMBSI=2000;
        aw.fullValue=2000;
        aw.PDDeductibleAmount=2000;
        aw.PDDeductible=2000;
        aw.WaitingPeriod=2000;
        aw.BIIndemnityPeriod=200;
        aw.MBPDDeductibleAmount=2000;
        aw.MBPDDeductible=2000;
        aw.MBWaitingPeriod=2000;
        aw.MBBIIndemnityPeriod=2000;
        aw.AdjustedPDPremium=2000;
        aw.AdjustedMBPremium=2000;
        aw.AdjustedBIPremium=20000;
        aw.AutomaticFirealarm=2000;
        aw.WaterSprinklers=2000;
        aw.FoamSupressionSystem=2000;
        aw.SmokeAndHeatVentingSystem=2000;
        aw.FulltimePublicFireBrigadeStaff=2000;
        aw.TotalDiscountLoading=2000;
        aw.NetPDPremium=2000;
        aw.NetBIPremium=2000;
        aw.NetRiskPremium=2000;
        cntr.assetList.add(aw);
        cntr.IsProperty=true;
        cntr.ps.id=null;
        cntr.finish();
        cntr.IsProperty=false;
        VG_Revise_NordicsProductSteps.PricingWrapper pw=new VG_Revise_NordicsProductSteps.PricingWrapper();
        pw.FactorName='Deductible';
        pw.factors.add(new SelectOption('2000>20000','2000>20000'));
        pw.price='2000.0';
        pw.order=1;
        pw.selectedFactor='';
        pw.productName='GLPL';
        pw.premiumMovement=2000;
        pw.premiumMovement_Converted=2000;
        pw.priceDecimal=2000;
        cntr.deductibleFactor=pw;
        cntr.attachment_Converted=2000000;
        cntr.limitAmount_Converted=200000;
        cntr.layer='Primary';
        cntr.Turnover_Converted=20000;
        cntr.UpdateFinalCalculations();
        cntr.updateExposure();
        Test.StopTest();
        Utilities.clearMethods();
    }
    
    
    public static testmethod void testmethod3(){
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('Edison Motor',acc.id);
        Asset__c ass=VG_TU.createAsset(acc.id);
        ass.MID_Notification_Complete__c=true;
        ass.VG_Full_Value_Building__c=56000000;
        update ass;
        pol.CurrencyIsoCode='SEK';
        pol.VG_Expiry_Date__c=Date.newInstance(2018, 12, 18);
        Update pol;
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        ps.Product__c='Property';
        ps.Limit__c=20000;
        ps.Attachment__c=2000000;
        ps.Sum_Insured__c=20000;
        ps.VG_Brokerage_Percent__c=20;
        ps.VG_Net_Base_Premium__c =20000;
        ps.Gross_Base_Premium__c=25000;
        ps.VG_MTA_End_Date__c = Date.newInstance(2019, 6, 18);
        update ps;
        List<VG_Pricing__c> priceList2=new List<VG_Pricing__c>();
        VG_pricing__c pr21=new VG_pricing__c();
        pr21.Name='Test Data21';
        pr21.VG_product__c='GLPL';
        pr21.VG_Level__c = 'Risk Detail';
        pr21.VG_Rate__c=4.60;
        pr21.VG_Rating_Factor__c='Construction - Surface construction';
        pr21.VG_Category__c = 'Type of operation';
        pr21.VG_Order__c=1;
        priceList2.add(pr21);
        VG_pricing__c pr22=new VG_pricing__c();
        pr22.Name='Test Data22';
        pr22.VG_product__c='Property';
        pr22.VG_Level__c = 'Risk Detail';
        pr22.VG_Rate__c=4.60;
        pr22.VG_Rating_Factor__c='Sport and convention halls - Without restaurant';
        pr22.VG_Category__c = 'BI Base Rate';
        pr22.VG_Order__c=1;
        priceList2.add(pr22);
        VG_pricing__c pr23=new VG_pricing__c();
        pr23.Name='Test Data23';
        pr23.VG_product__c='GLPL';
        pr23.VG_Level__c = 'Risk Detail';
        pr23.VG_Rate__c=4.60;
        pr23.VG_Rating_Factor__c='Construction - Underground construction';
        pr23.VG_Category__c = 'Type of operation';
        pr23.VG_Order__c=1;
        priceList2.add(pr23);
        VG_pricing__c pr4=new VG_pricing__c();
        pr4.Name='Test Data4';
        pr4.VG_product__c='FIPI';
        pr4.VG_Level__c = 'Risk Detail';
        pr4.VG_Rate__c=4.60;
        pr4.VG_Rating_Factor__c='Medium High';
        pr4.VG_Category__c = 'Transactional';
        pr4.VG_Order__c=1;
        priceList2.add(pr4);
        VG_pricing__c pr5=new VG_pricing__c();
        pr5.Name='Test Data5';
        pr5.VG_product__c='FIPI';
        pr5.VG_Level__c = 'Risk Detail';
        pr5.VG_Rate__c=4.60;
        pr5.VG_Rating_Factor__c='Medium';
        pr5.VG_Category__c = 'Transactional';
        pr5.VG_Order__c=1;
        priceList2.add(pr5);
        VG_pricing__c pr6=new VG_pricing__c();
        pr6.Name='Test Data6';
        pr6.VG_product__c='Clinical Trials';
        pr6.VG_Level__c = 'Risk Detail';
        pr6.VG_Rate__c=4.60;
        pr6.VG_Rating_Factor__c='  >250000';
        pr6.VG_Category__c = 'Deductible Adjustment';
        pr6.VG_Order__c=1;
        priceList2.add(pr6);
        VG_pricing__c pr7=new VG_pricing__c();
        pr7.Name='Test Data7';
        pr7.VG_product__c='Property';
        pr7.VG_Level__c = 'Risk Detail';
        pr7.VG_Rate__c=4.60;
        pr7.VG_Rating_Factor__c='Real Estate - Combustable buildings (wood etc)';
        pr7.VG_Category__c = 'PD Base Rate';
        pr7.VG_Order__c=1;
        priceList2.add(pr7);
        VG_pricing__c pr8=new VG_pricing__c();
        pr8.Name='Test Data8';
        pr8.VG_product__c='Property';
        pr8.VG_Level__c = 'Risk Detail';
        pr8.VG_Rate__c=4.60;
        pr8.VG_Rating_Factor__c='Medium low exposure';
        pr8.VG_Category__c = 'Machinery Breakdown Cover';
        pr8.VG_Order__c=1;
        priceList2.add(pr8);
        VG_pricing__c pr9=new VG_pricing__c();
        pr9.Name='Test Data9';
        pr9.VG_product__c='Property';
        pr9.VG_Level__c = 'Risk Detail';
        pr9.VG_Rate__c=4.60;
        pr9.VG_Rating_Factor__c='Medium low exposure';
        pr9.VG_Category__c = 'Machinery Breakdown BI Cover';
        pr9.VG_Order__c=1;
        priceList2.add(pr9);
        VG_pricing__c pr10=new VG_pricing__c();
        pr10.Name='Test Data10';
        pr10.VG_product__c='Property';
        pr10.VG_Level__c = 'Risk Detail';
        pr10.VG_Rate__c=4.60;
        pr10.VG_Rating_Factor__c='50000';
        pr10.VG_Category__c = 'Deductible Adjustment';
        pr10.VG_Order__c=1;
        priceList2.add(pr10);
        VG_pricing__c pr11=new VG_pricing__c();
        pr11.Name='Test Data11';
        pr11.VG_product__c='Property';
        pr11.VG_Level__c = 'Risk Detail';
        pr11.VG_Rate__c=4.60;
        pr11.VG_Rating_Factor__c='80000';
        pr11.VG_Category__c = 'Deductible Adjustment';
        pr11.VG_Order__c=1;
        priceList2.add(pr11);
        VG_pricing__c pr12=new VG_pricing__c();
        pr12.Name='Test Data12';
        pr12.VG_product__c='Property';
        pr12.VG_Level__c = 'Risk Detail';
        pr12.VG_Rate__c=4.60;
        pr12.VG_Rating_Factor__c='Yes';
        pr12.VG_Category__c = 'Inflammable or Explosive';
        pr12.VG_Order__c=1;
        priceList2.add(pr12);
        VG_pricing__c pr13=new VG_pricing__c();
        pr13.Name='Test Data13';
        pr13.VG_product__c='Property';
        pr13.VG_Level__c = 'Risk Detail';
        pr13.VG_Rate__c=4.60;
        pr13.VG_Rating_Factor__c='Yes';
        pr13.VG_Category__c = 'Pressure over 200 bar and/or temperature over 500 ºC';
        pr13.VG_Order__c=1;
        priceList2.add(pr13);
        VG_pricing__c pr14=new VG_pricing__c();
        pr14.Name='Test Data14';
        pr14.VG_product__c='Property';
        pr14.VG_Level__c = 'Risk Rating';
        pr14.VG_Rate__c=0.03;
        pr14.VG_Rating_Factor__c='250000';
        pr14.VG_Category__c = 'Deductible Adjustment';
        pr14.VG_Order__c=1;
        priceList2.add(pr14);
        VG_pricing__c pr15=new VG_pricing__c();
        pr15.Name='Test Data15';
        pr15.VG_product__c='Property';
        pr15.VG_Level__c = 'Risk Rating';
        pr15.VG_Rate__c=0.07;
        pr15.VG_Rating_Factor__c='1250000';
        pr15.VG_Category__c = 'Deductible Adjustment';
        pr15.VG_Order__c=1;
        priceList2.add(pr15);
        Insert priceList2;
        List<VG_Exposure_Premium__c> expList=new List<VG_Exposure_Premium__c>();
        VG_Exposure_Premium__c exp1 =new VG_Exposure_Premium__c();
        exp1.VG_Factor_Name__c='Hazardous Activity';
        exp1.VG_Other_Factor__c=false;
        exp1.VG_Policy_Schedule__c=ps.id;
        exp1.VG_Rate__c=0.8000;
        exp1.VG_Rating_Factor__c='0.80>Low';
        expList.add(exp1);
        VG_Exposure_Premium__c exp2 =new VG_Exposure_Premium__c();
        exp2.VG_Factor_Name__c='Hazardous Product';
        exp2.VG_Other_Factor__c=false;
        exp2.VG_Policy_Schedule__c=ps.id;
        exp2.VG_Rate__c=1.0000;
        exp2.VG_Rating_Factor__c='1.00>Medium Low';
        expList.add(exp2);
        VG_Exposure_Premium__c exp3 =new VG_Exposure_Premium__c();
        exp3.VG_Factor_Name__c='Risk Management';
        exp3.VG_Other_Factor__c=false;
        exp3.VG_Policy_Schedule__c=ps.id;
        exp3.VG_Rate__c=1.0000;
        exp3.VG_Rating_Factor__c='1.00>Medium Level';
        expList.add(exp3);
        VG_Exposure_Premium__c exp4 =new VG_Exposure_Premium__c();
        exp4.VG_Factor_Name__c='US Exports (% of Total)';
        exp4.VG_Other_Factor__c=false;
        exp4.VG_Policy_Schedule__c=ps.id;
        exp4.VG_Rate__c=1.6000;
        exp4.VG_Rating_Factor__c='1.60>0% - 5%';
        expList.add(exp4);
        VG_Exposure_Premium__c exp5 =new VG_Exposure_Premium__c();
        exp5.VG_Factor_Name__c='US Domiciled (% of Total)';
        exp5.VG_Other_Factor__c=false;
        exp5.VG_Policy_Schedule__c=ps.id;
        exp5.VG_Rate__c=1.0000;
        exp5.VG_Rating_Factor__c='1.00>0';
        expList.add(exp5);
        VG_Exposure_Premium__c exp6 =new VG_Exposure_Premium__c();
        exp6.VG_Factor_Name__c='null';
        exp6.VG_Other_Factor__c=true;
        exp6.VG_Policy_Schedule__c=ps.id;
        exp6.VG_Rate__c=0.0000;
        exp6.VG_Rating_Factor__c='null';
        expList.add(exp6);
        VG_Exposure_Premium__c exp7 =new VG_Exposure_Premium__c();
        exp7.VG_Factor_Name__c='null';
        exp7.VG_Other_Factor__c=true;
        exp7.VG_Policy_Schedule__c=ps.id;
        exp7.VG_Rate__c=0.0000;
        exp7.VG_Rating_Factor__c='null';
        expList.add(exp7);
        VG_Exposure_Premium__c exp8 =new VG_Exposure_Premium__c();
        exp8.VG_Factor_Name__c='null';
        exp8.VG_Other_Factor__c=true;
        exp8.VG_Policy_Schedule__c=ps.id;
        exp8.VG_Rate__c=0.0000;
        exp8.VG_Rating_Factor__c='null';
        expList.add(exp8);
        VG_Exposure_Premium__c exp9 =new VG_Exposure_Premium__c();
        exp9.VG_Factor_Name__c='Hazardous Activity';
        exp9.VG_Other_Factor__c=false;
        exp9.VG_Policy_Schedule__c=ps.id;
        exp9.VG_Rate__c=0.8000;
        exp9.VG_Rating_Factor__c='0.80>Low';
        expList.add(exp9);
        VG_Exposure_Premium__c exp10 =new VG_Exposure_Premium__c();
        exp10.VG_Factor_Name__c='Hazardous Product';
        exp10.VG_Other_Factor__c=false;
        exp10.VG_Policy_Schedule__c=ps.id;
        exp10.VG_Rate__c=1.0000;
        exp10.VG_Rating_Factor__c='1.00>Medium Low';
        expList.add(exp10);
        VG_Exposure_Premium__c exp11 =new VG_Exposure_Premium__c();
        exp11.VG_Factor_Name__c='Risk Management';
        exp11.VG_Other_Factor__c=false;
        exp11.VG_Policy_Schedule__c=ps.id;
        exp11.VG_Rate__c=1.0000;
        exp11.VG_Rating_Factor__c='1.00>Medium Level';
        expList.add(exp11);
        VG_Exposure_Premium__c exp12 =new VG_Exposure_Premium__c();
        exp12.VG_Factor_Name__c='US Exports (% of Total)';
        exp12.VG_Other_Factor__c=false;
        exp12.VG_Policy_Schedule__c=ps.id;
        exp12.VG_Rate__c=1.6000;
        exp12.VG_Rating_Factor__c='1.60>0% - 5%';
        expList.add(exp12);
        VG_Exposure_Premium__c exp13 =new VG_Exposure_Premium__c();
        exp13.VG_Factor_Name__c='US Domiciled (% of Total)';
        exp13.VG_Other_Factor__c=false;
        exp13.VG_Policy_Schedule__c=ps.id;
        exp13.VG_Rate__c=1.0000;
        exp13.VG_Rating_Factor__c='1.00>0';
        expList.add(exp13);
        VG_Exposure_Premium__c exp14 =new VG_Exposure_Premium__c();
        exp14.VG_Factor_Name__c='null';
        exp14.VG_Other_Factor__c=true;
        exp14.VG_Policy_Schedule__c=ps.id;
        exp14.VG_Rate__c=0.0000;
        exp14.VG_Rating_Factor__c='null';
        expList.add(exp14);
        VG_Exposure_Premium__c exp15 =new VG_Exposure_Premium__c();
        exp15.VG_Factor_Name__c='null';
        exp15.VG_Other_Factor__c=true;
        exp15.VG_Policy_Schedule__c=ps.id;
        exp15.VG_Rate__c=0.0000;
        exp15.VG_Rating_Factor__c='null';
        expList.add(exp15);
        VG_Exposure_Premium__c exp16 =new VG_Exposure_Premium__c();
        exp16.VG_Factor_Name__c='null';
        exp16.VG_Other_Factor__c=true;
        exp16.VG_Policy_Schedule__c=ps.id;
        exp16.VG_Rate__c=0.0000;
        exp16.VG_Rating_Factor__c='null';
        expList.add(exp16);
        Insert expList;
        List<VG_Pricing__c> priceList=new List<VG_Pricing__c>();
        VG_Pricing__c pr=new VG_Pricing__c();
        pr.Name='prTest1';
        pr.VG_Product__c='GLPL';
        pr.VG_Level__c = 'Risk Detail';
        pr.VG_Rate__c=1000;
        pr.VG_Rating_Factor__c='Agentur';
        pr.VG_Category__c = 'Type of operation';
        pr.VG_Order__c=1;
        priceList.add(pr);
        VG_Pricing__c pr3=pr.clone(false,true,false,false);
        priceList.add(pr3);
        VG_Pricing__c pr1=new VG_Pricing__c();
        pr1.Name='prTest2';
        pr1.VG_Product__c='GLPL';
        pr1.VG_Level__c = 'Risk Detail';
        pr1.VG_Rate__c=1000;
        pr1.VG_Rating_Factor__c='Agentur';
        pr1.VG_Category__c = 'Deductible Adjustment';
        pr1.VG_Order__c=1;
        priceList.add(pr1);
        VG_Pricing__c pr2=new VG_Pricing__c();
        pr2.Name='prTest3';
        pr2.VG_Product__c='Property';
        pr2.VG_Level__c = 'Risk Detail';
        pr2.VG_Rate__c=1000;
        pr2.VG_Rating_Factor__c='Agentur';
        pr2.VG_Category__c = 'Deductible Adjustment';
        pr2.VG_Order__c=1;
        priceList.add(pr2);
        Insert priceList;
        Endorsement_Library__c el=VG_TU.createEndorsementLibrary();
        el.RecordTypeId=Schema.SObjectType.Endorsement_Library__c.getRecordTypeInfosByName().get('Bridge').getRecordTypeId();
        Update el;
        Endorsement_Library__c el1=el.clone(false,true,false,false);
        el1.Type__c='Sub-limits';
        Insert el1;
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);
        pse.VG_Endorsement_Library_Id__c=el.id;
        update pse;
        VG_Policy_Schedule_Asset__c psa=VG_TU.createPolicyScheduleAsset(ps.id);
        VG_Policy_Schedule_Asset__c psa1=psa.clone(false,true,false,false);
        ApexPages.currentPage().getParameters().put('PSId', ps.id);
        ApexPages.currentPage().getParameters().put('policyId', pol.id);
        ApexPages.currentPage().getParameters().put('policyCurrency', 'USD');
        ApexPages.currentPage().getParameters().put('MTAType', 'Extension');
        VG_Revise_NordicsProductSteps cntr = new VG_Revise_NordicsProductSteps();
        VG_Revise_NordicsProductSteps.RRWrapper rrw=new VG_Revise_NordicsProductSteps.RRWrapper();
        VG_Revise_NordicsProductSteps.LibraryWrapper lw=new VG_Revise_NordicsProductSteps.LibraryWrapper();
        cntr.DeductibleRate_Converted=2000;
        cntr.techLayerPremium =2000;
        cntr.sharePercent=20;
        cntr.adjustment=2000;
        cntr.Turnover_Converted=20000;
        cntr.pricingRate='20000';
        cntr.experiencePremium_Converted=2000;
        cntr.seletedWeight=200;
        cntr.netExposurePremium=2000;
        RRW.psa = psa1;
        RRW.counter = '0';
        RRW.share=0;
        cntr.cancel();//completed
        cntr.gotostep1A();//completed
        cntr.price=pr2;
        cntr.gotostep3();//completed 
        el.VG_Product__c=cntr.price.VG_Product__c;
        update el;
        //cntr.LibraryWrapperList[0].IsSelected=false;
        //cntr.LibraryWrapperList1[0].IsSelected=false;
        cntr.gotostep4b();
        cntr.gotostep6b();
        cntr.AddCustom();
        VG_Policy_Schedule_Endorsement__c tempEndsmt = new VG_Policy_Schedule_Endorsement__c();
        tempEndsmt.CurrencyISOCode = 'USD';
        tempEndsmt.VG_Endorsement_Library_Id__c=el.id;
        tempEndsmt.VG_Premium__c = 1000;
        tempEndsmt.VG_Sub_limit__c=1000;
        cntr.existingEndorsements1.add(tempEndsmt);
        cntr.existingEndorsements[0].VG_Premium__c =1000;
        cntr.existingEndorsements[0].VG_Sub_limit__c =1000;
        //cntr.LibraryWrapperList[0].IsSelected=True;
        //cntr.LibraryWrapperList1[0].IsSelected=True;
        cntr.gotostep4();
        cntr.gotostep6();
        cntr.gotostep4b();
        cntr.gotostep6b();
        cntr.gotostep5();//completed
        cntr.addRR();//completed
        cntr.AddCustom();//completed
        cntr.Index='0';
        cntr.counter=0;
        cntr.RemoveRR();//completed
        //cntr.RemoveRR();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.RemoveAsset();//completed
        cntr.CancelAsset();//completed
        cntr.EditAsset();//completed
        cntr.setLPList();
        cntr.price.VG_Product__c='Commercial';
        cntr.setLPList();
        cntr.gotostep4();
        cntr.gotostep6();
        cntr.riskRatingList.add(RRW);
        cntr.IsProperty=false;
        cntr.gotostep4();
        cntr.gotostep6();
        cntr.price.VG_Product__c='GLPL';
        cntr.setLPList();
        cntr.price.VG_Product__c='Life Sciences';
        cntr.setLPList();
        cntr.price.VG_Product__c='D&O';
        cntr.setLPList();
        cntr.price.VG_Product__c='Clinical Trials';
        cntr.setLPList();
        cntr.price.VG_Product__c='Crime';
        cntr.setLPList();
        cntr.price.VG_Product__c='FIPI';
        cntr.setLPList();
        cntr.price.VG_Product__c='PI';
        cntr.setLPList();//completed
        cntr.existingEndorsements.add(tempEndsmt);
        cntr.existingEndorsements1.add(tempEndsmt.clone(false,true,false,false));
        VG_Revise_NordicsProductSteps.AssetWrapper aw=new VG_Revise_NordicsProductSteps.AssetWrapper();
        aw.asset=psa.clone(false,true,false,false);
        aw.Name='test';
        aw.totalPropertyDamageSI=2000;
        aw.totalBusinessInterruptionSI=200;
        aw.totalSumInsuredSI=2000;
        aw.totalSumInsuredMBSI=2000;
        aw.fullValue=2000;
        aw.PDDeductibleAmount=2000;
        aw.PDDeductible=2000;
        aw.WaitingPeriod=2000;
        aw.BIIndemnityPeriod=200;
        aw.MBPDDeductibleAmount=2000;
        aw.MBPDDeductible=2000;
        aw.MBWaitingPeriod=2000;
        aw.MBBIIndemnityPeriod=2000;
        aw.AdjustedPDPremium=2000;
        aw.AdjustedMBPremium=2000;
        aw.AdjustedBIPremium=20000;
        aw.AutomaticFirealarm=2000;
        aw.WaterSprinklers=2000;
        aw.FoamSupressionSystem=2000;
        aw.SmokeAndHeatVentingSystem=2000;
        aw.FulltimePublicFireBrigadeStaff=2000;
        aw.TotalDiscountLoading=2000;
        aw.NetPDPremium=2000;
        aw.NetBIPremium=2000;
        aw.NetRiskPremium=2000;
        cntr.assetList.add(aw);
        cntr.IsProperty=true;
        cntr.ps.id=null;
        cntr.ps.VG_MTA_End_Date__c = Date.newInstance(2019, 6, 18);
        Test.StartTest();
        cntr.finish();
        cntr.IsProperty=false;
        VG_Revise_NordicsProductSteps.PricingWrapper pw=new VG_Revise_NordicsProductSteps.PricingWrapper();
        pw.FactorName='Deductible';
        pw.factors.add(new SelectOption('2000>20000','2000>20000'));
        pw.price='2000.0';
        pw.order=1;
        pw.selectedFactor='';
        pw.productName='GLPL';
        pw.premiumMovement=2000;
        pw.premiumMovement_Converted=2000;
        pw.priceDecimal=2000;
        cntr.deductibleFactor=pw;
        cntr.attachment_Converted=2000000;
        cntr.limitAmount_Converted=200000;
        cntr.layer='Primary';
        cntr.Turnover_Converted=20000;
        cntr.UpdateFinalCalculations();
        cntr.updateExposure();
        Test.StopTest();
    }
    
    
    public static testmethod void testmethod4(){ 
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('Bridge',acc.id);
        Asset__c ass=VG_TU.createAsset(acc.id);
        ass.MID_Notification_Complete__c=true;
        ass.VG_Full_Value_Building__c=56000000;
        update ass;
        pol.CurrencyIsoCode='SEK';
        Update pol;
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        ps.VG_MTA_Start_Date__c = pol.VG_Expiry_Date__c=Date.newInstance(2017, 6, 18);
        Update ps;
        List<VG_Pricing__c> priceList2=new List<VG_Pricing__c>();
        VG_pricing__c pr21=new VG_pricing__c();
        pr21.Name='Test Data21';
        pr21.VG_product__c='GLPL';
        pr21.VG_Level__c = 'Risk Detail';
        pr21.VG_Rate__c=4.60;
        pr21.VG_Rating_Factor__c='Construction - Surface construction';
        pr21.VG_Category__c = 'Type of operation';
        pr21.VG_Order__c=1;
        priceList2.add(pr21);
        VG_pricing__c pr22=new VG_pricing__c();
        pr22.Name='Test Data22';
        pr22.VG_product__c='GLPL';
        pr22.VG_Level__c = 'Risk Detail';
        pr22.VG_Rate__c=4.60;
        pr22.VG_Rating_Factor__c='Sport and convention halls - Without restaurant';
        pr22.VG_Category__c = 'BI Base Rate';
        pr22.VG_Order__c=1;
        priceList2.add(pr22);
        VG_pricing__c pr23=new VG_pricing__c();
        pr23.Name='Test Data23';
        pr23.VG_product__c='GLPL';
        pr23.VG_Level__c = 'Risk Detail';
        pr23.VG_Rate__c=4.60;
        pr23.VG_Rating_Factor__c='Construction - Underground construction';
        pr23.VG_Category__c = 'Type of operation';
        pr23.VG_Order__c=1;
        priceList2.add(pr23);
        VG_pricing__c pr4=new VG_pricing__c();
        pr4.Name='Test Data4';
        pr4.VG_product__c='FIPI';
        pr4.VG_Level__c = 'Risk Detail';
        pr4.VG_Rate__c=4.60;
        pr4.VG_Rating_Factor__c='Medium High';
        pr4.VG_Category__c = 'Transactional';
        pr4.VG_Order__c=1;
        priceList2.add(pr4);
        VG_pricing__c pr5=new VG_pricing__c();
        pr5.Name='Test Data5';
        pr5.VG_product__c='FIPI';
        pr5.VG_Level__c = 'Risk Detail';
        pr5.VG_Rate__c=4.60;
        pr5.VG_Rating_Factor__c='Medium';
        pr5.VG_Category__c = 'Transactional';
        pr5.VG_Order__c=1;
        priceList2.add(pr5);
        VG_pricing__c pr6=new VG_pricing__c();
        pr6.Name='Test Data6';
        pr6.VG_product__c='Clinical Trials';
        pr6.VG_Level__c = 'Risk Detail';
        pr6.VG_Rate__c=4.60;
        pr6.VG_Rating_Factor__c='  >250000';
        pr6.VG_Category__c = 'Deductible Adjustment';
        pr6.VG_Order__c=1;
        priceList2.add(pr6);
        VG_pricing__c pr7=new VG_pricing__c();
        pr7.Name='Test Data7';
        pr7.VG_product__c='GLPL';
        pr7.VG_Level__c = 'Risk Detail';
        pr7.VG_Rate__c=4.60;
        pr7.VG_Rating_Factor__c='Real Estate - Combustable buildings (wood etc)';
        pr7.VG_Category__c = 'PD Base Rate';
        pr7.VG_Order__c=1;
        priceList2.add(pr7);
        VG_pricing__c pr8=new VG_pricing__c();
        pr8.Name='Test Data8';
        pr8.VG_product__c='GLPL';
        pr8.VG_Level__c = 'Risk Detail';
        pr8.VG_Rate__c=4.60;
        pr8.VG_Rating_Factor__c='Medium low exposure';
        pr8.VG_Category__c = 'Machinery Breakdown Cover';
        pr8.VG_Order__c=1;
        priceList2.add(pr8);
        VG_pricing__c pr9=new VG_pricing__c();
        pr9.Name='Test Data9';
        pr9.VG_product__c='GLPL';
        pr9.VG_Level__c = 'Risk Detail';
        pr9.VG_Rate__c=4.60;
        pr9.VG_Rating_Factor__c='Medium low exposure';
        pr9.VG_Category__c = 'Machinery Breakdown BI Cover';
        pr9.VG_Order__c=1;
        priceList2.add(pr9);
        VG_pricing__c pr10=new VG_pricing__c();
        pr10.Name='Test Data10';
        pr10.VG_product__c='GLPL';
        pr10.VG_Level__c = 'Risk Detail';
        pr10.VG_Rate__c=4.60;
        pr10.VG_Rating_Factor__c='50000';
        pr10.VG_Category__c = 'Deductible Adjustment';
        pr10.VG_Order__c=1;
        priceList2.add(pr10);
        VG_pricing__c pr11=new VG_pricing__c();
        pr11.Name='Test Data11';
        pr11.VG_product__c='GLPL';
        pr11.VG_Level__c = 'Risk Detail';
        pr11.VG_Rate__c=4.60;
        pr11.VG_Rating_Factor__c='80000';
        pr11.VG_Category__c = 'Deductible Adjustment';
        pr11.VG_Order__c=1;
        priceList2.add(pr11);
        VG_pricing__c pr12=new VG_pricing__c();
        pr12.Name='Test Data12';
        pr12.VG_product__c='GLPL';
        pr12.VG_Level__c = 'Risk Detail';
        pr12.VG_Rate__c=4.60;
        pr12.VG_Rating_Factor__c='Yes';
        pr12.VG_Category__c = 'Inflammable or Explosive';
        pr12.VG_Order__c=1;
        priceList2.add(pr12);
        VG_pricing__c pr13=new VG_pricing__c();
        pr13.Name='Test Data13';
        pr13.VG_product__c='GLPL';
        pr13.VG_Level__c = 'Risk Detail';
        pr13.VG_Rate__c=4.60;
        pr13.VG_Rating_Factor__c='Yes';
        pr13.VG_Category__c = 'Pressure over 200 bar and/or temperature over 500 ºC';
        pr13.VG_Order__c=1;
        priceList2.add(pr13);
        VG_pricing__c pr14=new VG_pricing__c();
        pr14.Name='Test Data14';
        pr14.VG_product__c='GLPL';
        pr14.VG_Level__c = 'Risk Rating';
        pr14.VG_Rate__c=0.03;
        pr14.VG_Rating_Factor__c='250000';
        pr14.VG_Category__c = 'Deductible Adjustment';
        pr14.VG_Order__c=1;
        priceList2.add(pr14);
        VG_pricing__c pr15=new VG_pricing__c();
        pr15.Name='Test Data15';
        pr15.VG_product__c='GLPL';
        pr15.VG_Level__c = 'Risk Rating';
        pr15.VG_Rate__c=0.07;
        pr15.VG_Rating_Factor__c='1250000';
        pr15.VG_Category__c = 'Deductible Adjustment';
        pr15.VG_Order__c=1;
        priceList2.add(pr15);
        Insert priceList2;
        List<VG_Exposure_Premium__c> expList=new List<VG_Exposure_Premium__c>();
        VG_Exposure_Premium__c exp1 =new VG_Exposure_Premium__c();
        exp1.VG_Factor_Name__c='Hazardous Activity';
        exp1.VG_Other_Factor__c=false;
        exp1.VG_Policy_Schedule__c=ps.id;
        exp1.VG_Rate__c=0.8000;
        exp1.VG_Rating_Factor__c='0.80>Low';
        expList.add(exp1);
        VG_Exposure_Premium__c exp2 =new VG_Exposure_Premium__c();
        exp2.VG_Factor_Name__c='Hazardous Product';
        exp2.VG_Other_Factor__c=false;
        exp2.VG_Policy_Schedule__c=ps.id;
        exp2.VG_Rate__c=1.0000;
        exp2.VG_Rating_Factor__c='1.00>Medium Low';
        expList.add(exp2);
        VG_Exposure_Premium__c exp3 =new VG_Exposure_Premium__c();
        exp3.VG_Factor_Name__c='Risk Management';
        exp3.VG_Other_Factor__c=false;
        exp3.VG_Policy_Schedule__c=ps.id;
        exp3.VG_Rate__c=1.0000;
        exp3.VG_Rating_Factor__c='1.00>Medium Level';
        expList.add(exp3);
        VG_Exposure_Premium__c exp4 =new VG_Exposure_Premium__c();
        exp4.VG_Factor_Name__c='US Exports (% of Total)';
        exp4.VG_Other_Factor__c=false;
        exp4.VG_Policy_Schedule__c=ps.id;
        exp4.VG_Rate__c=1.6000;
        exp4.VG_Rating_Factor__c='1.60>0% - 5%';
        expList.add(exp4);
        VG_Exposure_Premium__c exp5 =new VG_Exposure_Premium__c();
        exp5.VG_Factor_Name__c='US Domiciled (% of Total)';
        exp5.VG_Other_Factor__c=false;
        exp5.VG_Policy_Schedule__c=ps.id;
        exp5.VG_Rate__c=1.0000;
        exp5.VG_Rating_Factor__c='1.00>0';
        expList.add(exp5);
        VG_Exposure_Premium__c exp6 =new VG_Exposure_Premium__c();
        exp6.VG_Factor_Name__c='null';
        exp6.VG_Other_Factor__c=true;
        exp6.VG_Policy_Schedule__c=ps.id;
        exp6.VG_Rate__c=0.0000;
        exp6.VG_Rating_Factor__c='null';
        expList.add(exp6);
        VG_Exposure_Premium__c exp7 =new VG_Exposure_Premium__c();
        exp7.VG_Factor_Name__c='null';
        exp7.VG_Other_Factor__c=true;
        exp7.VG_Policy_Schedule__c=ps.id;
        exp7.VG_Rate__c=0.0000;
        exp7.VG_Rating_Factor__c='null';
        expList.add(exp7);
        VG_Exposure_Premium__c exp8 =new VG_Exposure_Premium__c();
        exp8.VG_Factor_Name__c='null';
        exp8.VG_Other_Factor__c=true;
        exp8.VG_Policy_Schedule__c=ps.id;
        exp8.VG_Rate__c=0.0000;
        exp8.VG_Rating_Factor__c='null';
        expList.add(exp8);
        VG_Exposure_Premium__c exp9 =new VG_Exposure_Premium__c();
        exp9.VG_Factor_Name__c='Hazardous Activity';
        exp9.VG_Other_Factor__c=false;
        exp9.VG_Policy_Schedule__c=ps.id;
        exp9.VG_Rate__c=0.8000;
        exp9.VG_Rating_Factor__c='0.80>Low';
        expList.add(exp9);
        VG_Exposure_Premium__c exp10 =new VG_Exposure_Premium__c();
        exp10.VG_Factor_Name__c='Hazardous Product';
        exp10.VG_Other_Factor__c=false;
        exp10.VG_Policy_Schedule__c=ps.id;
        exp10.VG_Rate__c=1.0000;
        exp10.VG_Rating_Factor__c='1.00>Medium Low';
        expList.add(exp10);
        VG_Exposure_Premium__c exp11 =new VG_Exposure_Premium__c();
        exp11.VG_Factor_Name__c='Risk Management';
        exp11.VG_Other_Factor__c=false;
        exp11.VG_Policy_Schedule__c=ps.id;
        exp11.VG_Rate__c=1.0000;
        exp11.VG_Rating_Factor__c='1.00>Medium Level';
        expList.add(exp11);
        VG_Exposure_Premium__c exp12 =new VG_Exposure_Premium__c();
        exp12.VG_Factor_Name__c='US Exports (% of Total)';
        exp12.VG_Other_Factor__c=false;
        exp12.VG_Policy_Schedule__c=ps.id;
        exp12.VG_Rate__c=1.6000;
        exp12.VG_Rating_Factor__c='1.60>0% - 5%';
        expList.add(exp12);
        VG_Exposure_Premium__c exp13 =new VG_Exposure_Premium__c();
        exp13.VG_Factor_Name__c='US Domiciled (% of Total)';
        exp13.VG_Other_Factor__c=false;
        exp13.VG_Policy_Schedule__c=ps.id;
        exp13.VG_Rate__c=1.0000;
        exp13.VG_Rating_Factor__c='1.00>0';
        expList.add(exp13);
        VG_Exposure_Premium__c exp14 =new VG_Exposure_Premium__c();
        exp14.VG_Factor_Name__c='null';
        exp14.VG_Other_Factor__c=true;
        exp14.VG_Policy_Schedule__c=ps.id;
        exp14.VG_Rate__c=0.0000;
        exp14.VG_Rating_Factor__c='null';
        expList.add(exp14);
        VG_Exposure_Premium__c exp15 =new VG_Exposure_Premium__c();
        exp15.VG_Factor_Name__c='null';
        exp15.VG_Other_Factor__c=true;
        exp15.VG_Policy_Schedule__c=ps.id;
        exp15.VG_Rate__c=0.0000;
        exp15.VG_Rating_Factor__c='null';
        expList.add(exp15);
        VG_Exposure_Premium__c exp16 =new VG_Exposure_Premium__c();
        exp16.VG_Factor_Name__c='null';
        exp16.VG_Other_Factor__c=true;
        exp16.VG_Policy_Schedule__c=ps.id;
        exp16.VG_Rate__c=0.0000;
        exp16.VG_Rating_Factor__c='null';
        expList.add(exp16);
        Insert expList;
        List<VG_Pricing__c> priceList=new List<VG_Pricing__c>();
        VG_Pricing__c pr=new VG_Pricing__c();
        pr.Name='prTest1';
        pr.VG_Product__c='GLPL';
        pr.VG_Level__c = 'Risk Detail';
        pr.VG_Rate__c=1000;
        pr.VG_Rating_Factor__c='Agentur';
        pr.VG_Category__c = 'Type of operation';
        pr.VG_Order__c=1;
        priceList.add(pr);
        VG_Pricing__c pr3=pr.clone(false,true,false,false);
        priceList.add(pr3);
        VG_Pricing__c pr1=new VG_Pricing__c();
        pr1.Name='prTest2';
        pr1.VG_Product__c='GLPL';
        pr1.VG_Level__c = 'Risk Detail';
        pr1.VG_Rate__c=1000;
        pr1.VG_Rating_Factor__c='Agentur';
        pr1.VG_Category__c = 'Deductible Adjustment';
        pr1.VG_Order__c=1;
        priceList.add(pr1);
        VG_Pricing__c pr2=new VG_Pricing__c();
        pr2.Name='prTest3';
        pr2.VG_Product__c='GLPL';
        pr2.VG_Level__c = 'Risk Detail';
        pr2.VG_Rate__c=1000;
        pr2.VG_Rating_Factor__c='Agentur';
        pr2.VG_Category__c = 'Deductible Adjustment';
        pr2.VG_Order__c=1;
        priceList.add(pr2);
        Insert priceList;
        Endorsement_Library__c el=VG_TU.createEndorsementLibrary();
        el.RecordTypeId=Schema.SObjectType.Endorsement_Library__c.getRecordTypeInfosByName().get('Bridge').getRecordTypeId();
        Update el;
        Endorsement_Library__c el1=el.clone(false,true,false,false);
        el1.Type__c='Sub-limits';
        Insert el1;
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);
        pse.VG_Endorsement_Library_Id__c=el.id;
        update pse;
        VG_Policy_Schedule_Asset__c psa=VG_TU.createPolicyScheduleAsset(ps.id);
        VG_Policy_Schedule_Asset__c psa1=psa.clone(false,true,false,false);
        ApexPages.currentPage().getParameters().put('PSId', ps.id);
        ApexPages.currentPage().getParameters().put('Currency', pol.CurrencyIsoCode);
        VG_Revise_NordicsProductSteps cntr = new VG_Revise_NordicsProductSteps();
        VG_Revise_NordicsProductSteps.RRWrapper rrw=new VG_Revise_NordicsProductSteps.RRWrapper();
        VG_Revise_NordicsProductSteps.LibraryWrapper lw=new VG_Revise_NordicsProductSteps.LibraryWrapper();
        cntr.DeductibleRate_Converted=2000;
        cntr.techLayerPremium =2000;
        cntr.sharePercent=20;
        cntr.adjustment=2000;
        cntr.Turnover_Converted=20000;
        cntr.pricingRate='20000';
        cntr.experiencePremium_Converted=2000;
        cntr.seletedWeight=200;
        cntr.netExposurePremium=2000;
        cntr.PDBaseRate=2.3;
        cntr.adjustmentFactor=25.3;
        //cntr.cancel();//completed
        cntr.gotostep1A();//completed
        cntr.gotostep2();
        cntr.price=pr2;
        cntr.PDBaseRate=2.3;
        cntr.adjustmentFactor=25.3;
        //cntr.gotostep2();
        cntr.gotostep3();//completed 
        el.VG_Product__c=cntr.price.VG_Product__c;
        update el;
        cntr.gotostep4();
        cntr.gotostep6();
        //cntr.LibraryWrapperList[0].IsSelected=false;
        //cntr.LibraryWrapperList1[0].IsSelected=false;
        cntr.gotostep4b();
        cntr.gotostep6b();
        cntr.AddCustom();
        VG_Policy_Schedule_Endorsement__c tempEndsmt = new VG_Policy_Schedule_Endorsement__c();
        tempEndsmt.CurrencyISOCode = 'USD';
        tempEndsmt.VG_Endorsement_Library_Id__c=el.id;
        tempEndsmt.VG_Premium__c = 1000;
        tempEndsmt.VG_Sub_limit__c=1000;
        cntr.existingEndorsements1.add(tempEndsmt);
        cntr.existingEndorsements[0].VG_Premium__c =1000;
        cntr.existingEndorsements[0].VG_Sub_limit__c =1000;
        //cntr.LibraryWrapperList[0].IsSelected=True;
        //cntr.LibraryWrapperList1[0].IsSelected=True;
        cntr.gotostep4b();
        cntr.gotostep6b();
        cntr.gotostep5();//completed
        cntr.addRR();//completed
        cntr.AddCustom();//completed
        cntr.Index='0';
        cntr.counter=0;
        cntr.RemoveRR();//completed
        cntr.RemoveRR();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.AddAsset();//completed
        cntr.SaveAsset();//completed
        cntr.RemoveAsset();//completed
        cntr.CancelAsset();//completed
        cntr.EditAsset();//completed
        cntr.setLPList();
        cntr.price.VG_Product__c='Commercial';
        cntr.setLPList();
        cntr.gotostep4();
        cntr.gotostep6();
        cntr.IsProperty=false;
        cntr.gotostep4();
        cntr.gotostep6();
        cntr.price.VG_Product__c='GLPL';
        cntr.setLPList();
        cntr.price.VG_Product__c='Life Sciences';
        cntr.setLPList();
        cntr.price.VG_Product__c='D&O';
        cntr.setLPList();
        cntr.price.VG_Product__c='Clinical Trials';
        cntr.setLPList();
        cntr.price.VG_Product__c='Crime';
        cntr.setLPList();
        cntr.price.VG_Product__c='FIPI';
        cntr.setLPList();
        cntr.price.VG_Product__c='PI';
        cntr.setLPList();//completed
        Test.StartTest();
        cntr.finish();
        cntr.existingEndorsements.add(tempEndsmt);
        cntr.existingEndorsements1.add(tempEndsmt.clone(false,true,false,false));
        VG_Revise_NordicsProductSteps.AssetWrapper aw=new VG_Revise_NordicsProductSteps.AssetWrapper();
        cntr.ps.id=null;
        cntr.finish();
        cntr.IsProperty=false;
        VG_Revise_NordicsProductSteps.PricingWrapper pw=new VG_Revise_NordicsProductSteps.PricingWrapper();
        pw.FactorName='Deductible';
        pw.factors.add(new SelectOption('2000>20000','2000>20000'));
        pw.price='2000.0';
        pw.order=1;
        pw.selectedFactor='';
        pw.productName='GLPL';
        pw.premiumMovement=2000;
        pw.premiumMovement_Converted=2000;
        pw.priceDecimal=2000;
        cntr.deductibleFactor=pw;
        cntr.attachment_Converted=2000000;
        cntr.limitAmount_Converted=200000;
        cntr.UpdateFinalCalculations();
        cntr.layer='Primary';
        cntr.UpdateFinalCalculations();
        cntr.Turnover_Converted=20000;
        cntr.updateExposure();
        //cntr.UpdateAssetPremium();
        Test.StopTest();
    }
}