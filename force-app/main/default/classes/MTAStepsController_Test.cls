@IsTest(SeeAllData=False)
public class MTAStepsController_Test {
    public static testMethod void TestMethodROCVFP() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('VFP',acc.id);
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);       
        Endorsement_Library__c EL1=VG_TU.createEndorsementLibraryCustom('VFP','Sub-limits');        
        Endorsement_Library__c EL2=VG_TU.createEndorsementLibraryCustom('VFP','Endorsements');       
        Endorsement_Library__c EL=VG_TU.createEndorsementLibrary();
        EL.RecordTypeId=Schema.SObjectType.Endorsement_Library__c.getRecordTypeInfosByName().get('VFP').getRecordTypeId();
        EL.VG_Product__c='Property';        
        update EL;
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);        
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('RecordType', 'VFP');
        MTAStepsController.PSWrapper psw = new MTAStepsController.PSWrapper();
        MTAStepsController mta=new MTAStepsController();
        mta.gotostep1();
        mta.seletedType ='Revision of Cover'; 
        mta.RecordType = 'VFP';
        mta.seletedProrateoption = 'Flat';
        mta.gotostep2();
        mta.seletedProrateoption = 'Prorated';
        mta.gotoStep4();   
        
    }   
    
    public static testMethod void TestMethodROCAesir() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('Aesir',acc.id);
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);       
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('RecordType', 'Aesir');
        MTAStepsController.PSWrapper psw = new MTAStepsController.PSWrapper();
        MTAStepsController mta=new MTAStepsController();
        mta.gotostep1();
        mta.seletedType ='Revision of Cover'; 
        mta.gotoStep4();           
    }   
    
    public static testMethod void TestMethodROCImara() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('Imara',acc.id);
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id); 
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('RecordType', 'Imara');
        MTAStepsController.PSWrapper psw = new MTAStepsController.PSWrapper();
        MTAStepsController mta=new MTAStepsController();
        mta.gotostep1();
        mta.seletedType ='Revision of Cover'; 
        mta.gotoStep4();
    }  
    
    public static testMethod void TestMethodROCHorizon() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('Horizon',acc.id);
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);       
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('RecordType', 'Horizon');
        MTAStepsController.PSWrapper psw = new MTAStepsController.PSWrapper();
        MTAStepsController mta=new MTAStepsController();
        mta.gotostep1();
        mta.seletedType ='Revision of Cover'; 
        mta.gotoStep4();          
    }  
    
    public static testMethod void TestMethodROCAffinity() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('Affinity',acc.id);
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);       
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('RecordType', 'Affinity');
        MTAStepsController.PSWrapper psw = new MTAStepsController.PSWrapper();
        MTAStepsController mta=new MTAStepsController();
        mta.gotostep1();
        mta.seletedType ='Revision of Cover'; 
        mta.gotoStep4();          
    } 
    
    public static testMethod void TestMethodROCGentium() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('Gentium',acc.id);
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);       
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('RecordType', 'GentiumScheme');
        MTAStepsController.PSWrapper psw = new MTAStepsController.PSWrapper();
        MTAStepsController mta=new MTAStepsController();
        mta.gotostep1();
        mta.seletedType ='Revision of Cover'; 
        mta.gotoStep4();          
    } 
    
    public static testMethod void TestMethodVFP1() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Utilities.SkipMethods('Bridge Context');  
        Policy__c pol=VG_TU.createPolicy('VFP',acc.id);
        pol.VG_Inception_Date__c=Date.newInstance(2019, 12, 18);
        pol.VG_Expiry_Date__c=Date.newInstance(2020, 12, 18);
        update pol;
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id); 
        ps.VG_MTA_Type__c ='Revision of Cover';
        ps.VG_Is_MTA__c = true;
        ps.Technical_UW_Premium__c=7000;
        Ps.Premium_Adjustment__c=5000;
        ps.VG_Fee_Income__c=500;  
        ps.VG_MTA_Reduction_Date__c =Date.newInstance(2020, 5, 18);
        ps.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2019, 12, 19);
        ps.VG_MTA_Start_Date__c =Date.newInstance(2019, 12, 19);
        ps.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        update ps;
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);     
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);   
        Test.startTest();
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        MTAStepsController mta=new MTAStepsController();        
        mta.gotostep1();
        mta.gotostep2();
        mta.seletedType  =  '--Select--';
        mta.gotostep2();
        mta.seletedType='Extension';
        mta.seletedProrateoption = 'Flat';
        mta.UpdateAdjustmentvalues();
        mta.calcJunction();
        mta.seletedProrateoption = 'Prorated';
        mta.UpdateAdjustmentvalues();
        mta.calcJunction();
        mta.finish();  
        pol.VG_Expiry_Date__c = ps.VG_MTA_End_Date__c;
        update pol;  
        mta.Cancel();
        Utilities.clearMethods();
        Test.stopTest();
    }

    /*public static testMethod void TestMethodVFP2() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('VFP',acc.id);
        pol.VG_Inception_Date__c=Date.newInstance(2017, 12, 18);
        pol.VG_Expiry_Date__c=Date.newInstance(2020, 12, 18);
        update pol;
        
        Test.startTest();        
        List<Policy_Schedule__c> pslist = new List<Policy_Schedule__c>(); 
        Policy_Schedule__c ps0=VG_TU.createPolicySchedule(pol.id);
        ps0.VG_MTA_Cancellation_Date__c=Date.newInstance(2018, 2, 1);
        ps0.VG_MTA_Reduction_Date__c =Date.newInstance(2018, 2, 1);
        ps0.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2018, 12, 19);        
        ps0.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps0.VG_MTA_Start_Date__c=Date.newInstance(2018, 12, 18);
        update ps0;
        Policy_Schedule__c ps=ps0.clone(false,true,false,false);
        ps.Technical_UW_Premium__c=7000;
        ps.VG_Is_MTA__c = false;
        pslist.add(ps);               
        Policy_Schedule__c ps1=ps.clone(false,true,false,false);
        ps1.VG_Is_MTA__c=True;
        ps1.VG_MTA_Type__c = 'Revision of Cover';
        ps1.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps1.VG_MTA_Start_Date__c=Date.newInstance(2018, 10, 18);
        pslist.add(ps1);
        Policy_Schedule__c ps2=ps.clone(false,true,false,false);
        ps2.VG_Is_MTA__c=True;
        ps2.VG_MTA_Type__c = 'Extension';
        ps2.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps2.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps2);
        Policy_Schedule__c ps3=ps1.clone(false,true,false,false); 
        ps3.VG_Is_MTA__c=True;
        ps3.VG_MTA_Type__c = 'Extension';
        ps3.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps3.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps3);
        Insert pslist;        
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id); 
        rr.VG_Sum_Insured__c = 4870;
        update rr;
        VG_Policy_Schedule_Asset__c rr1=VG_TU.createPolicyScheduleAsset(ps1.id); 
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);        
        VG_Policy_Schedule_Endorsement__c pse2=VG_TU.createPolicyScheduleEndorsement(ps.id);        
        pse2.VG_Type__c = 'Sub-limits';
        update pse2;
        Risk_Capture__c rc = VG_TU.createRiskCapture(ps.id);
        rc.VG_Company_Type__c='Public';
        rc.VG_Company_Domicile__c='UK';
        rc.VG_Industry__c='Energy';
        rc.VG_Total_Assets__c=500000;
        rc.VG_Revenue__c   =50000;
        rc.VG_Market_Cap__c=50000;
        rc.VG_Net_Profit__c=50000;
        rc.VG_Net_Equity__c=50000;
        rc.VG_Headcount__c=2;
        rc.VG_Class_1_Employees__c=2;
        rc.VG_No_of_Reinstatements__c = String.valueOf(2);
        update rc;
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        ApexPages.currentPage().getParameters().put('PSID', ps0.id);        
        MTAStepsController mta=new MTAStepsController();             
        mta.gotostep1();
        mta.seletedType='Reduction'; 
        mta.gotostep2();
        mta.MTAcancellationDate = ps0.VG_MTA_Reduction_Date__c;
        mta.UpdateAdjustmentvalues();                
        mta.calcJunction();
        mta.gotoStep4();        
        mta.finish();  
        mta.Cancel();
        MTAStepsController mta1=new MTAStepsController();             
        mta1.gotostep1();
        mta1.seletedType='Cancellation';   
        mta1.gotostep2();
        mta1.MTAcancellationDate = ps0.VG_MTA_Cancellation_Date__c;
        mta1.UpdateAdjustmentvalues();                
        mta1.calcJunction();
        mta1.gotoStep4();        
        mta1.finish();
        Test.stopTest(); 
        
    }*/
    
   public static testMethod void TestMethodVFP3() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Utilities.SkipMethods('Bridge Context');  
        Policy__c pol=VG_TU.createPolicy('VFP',acc.id);
        pol.VG_Inception_Date__c=Date.newInstance(2017, 12, 18);
        pol.VG_Expiry_Date__c =Date.newInstance(2019, 1, 18);
        update pol;                
		Test.startTest();        
        List<Policy_Schedule__c> pslist = new List<Policy_Schedule__c>(); 
        Policy_Schedule__c ps0=VG_TU.createPolicySchedule(pol.id); 
        ps0.VG_MTA_Cancellation_Date__c=Date.newInstance(2018, 12, 19);
        ps0.VG_MTA_Reduction_Date__c =Date.newInstance(2018, 2, 1);
        ps0.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2018, 12, 19);        
        ps0.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps0.VG_MTA_Start_Date__c=Date.newInstance(2018, 12, 18);
        update ps0;
        Policy_Schedule__c ps=ps0.clone(false,true,false,false);
        ps.Technical_UW_Premium__c=7000;
        ps.VG_Is_MTA__c = false;
        pslist.add(ps);               
        Policy_Schedule__c ps1=ps.clone(false,true,false,false);
        ps1.VG_Is_MTA__c=True;
        ps1.VG_MTA_Type__c = 'Revision of Cover';
        ps1.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps1.VG_MTA_Start_Date__c=Date.newInstance(2018, 10, 18);
        pslist.add(ps1);
        Policy_Schedule__c ps2=ps.clone(false,true,false,false);
        ps2.VG_Is_MTA__c=True;
        ps2.VG_MTA_Type__c = 'Extension';
        ps2.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps2.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps2);
        Policy_Schedule__c ps3=ps1.clone(false,true,false,false);
        ps3.VG_Is_MTA__c=True;
        ps3.VG_MTA_Type__c = 'Extension';
        ps3.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps3.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps3);
        Insert pslist;        
        VG_Policy_Schedule_Asset__c rr1=VG_TU.createPolicyScheduleAsset(ps1.id); 
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);        
        Risk_Capture__c rc = VG_TU.createRiskCapture(ps.id);
        rc.VG_Company_Type__c='Public';
        rc.VG_Company_Domicile__c='UK';
        rc.VG_Industry__c='Energy';
        rc.VG_Total_Assets__c=500000;
        rc.VG_Revenue__c   =50000;
        rc.VG_Market_Cap__c=50000;
        rc.VG_Net_Profit__c=50000;
        rc.VG_Net_Equity__c=50000;
        rc.VG_Headcount__c=2;
        rc.VG_Class_1_Employees__c=2;
        rc.VG_No_of_Reinstatements__c = String.valueOf(2);
        update rc;
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        ApexPages.currentPage().getParameters().put('PSID', ps0.id);        
        MTAStepsController mta=new MTAStepsController();             
        mta.gotostep1();
        mta.seletedType='Reduction';   
        mta.gotostep2();
        mta.MTAcancellationDate = ps0.VG_MTA_Reduction_Date__c;
        mta.calcJunction();
        mta.UpdateAdjustmentvalues();        
        mta.gotoStep4();        
        mta.finish();  
        mta.Cancel();
        MTAStepsController mta1=new MTAStepsController();             
        mta1.gotostep1();
        mta1.seletedType='Cancellation';   
        mta1.gotostep2();
        mta1.MTAcancellationDate = ps0.VG_MTA_Cancellation_Date__c;
        mta1.UpdateAdjustmentvalues();                
        mta1.calcJunction();
        mta1.gotoStep4();        
        mta1.finish();
        Utilities.clearMethods();
        Test.stopTest(); 
        
    }
    
    
    public static testMethod void TestMethodImara1() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Utilities.SkipMethods('Trigger Context2');
        Policy__c pol=VG_TU.createPolicy('Imara',acc.id);
        pol.VG_Inception_Date__c=Date.newInstance(2019, 12, 18);
        pol.VG_Expiry_Date__c=Date.newInstance(2020, 12, 18);
        update pol;
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id); 
        ps.VG_MTA_Type__c ='Revision of Cover';
        ps.VG_Is_MTA__c = true;
        ps.Technical_UW_Premium__c=7000;
        Ps.Premium_Adjustment__c=5000;
        ps.VG_Fee_Income__c=500;  
        ps.VG_MTA_Reduction_Date__c =Date.newInstance(2020, 5, 18);
        ps.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2019, 12, 19);
        ps.VG_MTA_Start_Date__c =Date.newInstance(2019, 12, 19);
        ps.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        update ps;
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);     
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);   
        Test.startTest();
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        MTAStepsController mta=new MTAStepsController();        
        mta.gotostep1();
        mta.gotostep2();
        mta.seletedType='Reduction';
        mta.gotostep2();
        mta.seletedType='Extension';
        mta.seletedProrateoption = 'Flat';
        mta.UpdateAdjustmentvalues();
        mta.calcJunction();
        mta.seletedProrateoption = 'Prorated';
        mta.calcJunction();
        mta.finish();  
        pol.VG_Expiry_Date__c = ps.VG_MTA_End_Date__c;
        update pol;  
        mta.Cancel();
        Utilities.clearMethods();
        Test.stopTest();
    }

    public static testMethod void TestMethodImara2() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Utilities.SkipMethods('Bridge Context');  
        Policy__c pol=VG_TU.createPolicy('Imara',acc.id);
        pol.VG_Inception_Date__c=Date.newInstance(2019, 12, 18);
        pol.VG_Expiry_Date__c=Date.newInstance(2020, 12, 18);
        update pol;        
        Test.startTest();       
        List<Policy_Schedule__c> pslist = new List<Policy_Schedule__c>(); 
        Policy_Schedule__c ps0=VG_TU.createPolicySchedule(pol.id); 
        ps0.VG_MTA_Cancellation_Date__c=Date.newInstance(2018, 2, 1);
        ps0.VG_MTA_Reduction_Date__c =Date.newInstance(2018, 2, 1);
        ps0.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2018, 12, 19);        
        ps0.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps0.VG_MTA_Start_Date__c=Date.newInstance(2018, 12, 18);
        update ps0;
        Policy_Schedule__c ps=ps0.clone(false,true,false,false);
        ps.Technical_UW_Premium__c=7000;
        ps.VG_Is_MTA__c = false;
        pslist.add(ps);               
        Policy_Schedule__c ps1=ps.clone(false,true,false,false);
        ps1.VG_Is_MTA__c=True;
        ps1.VG_MTA_Type__c = 'Revision of Cover';
        ps1.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps1.VG_MTA_Start_Date__c=Date.newInstance(2018, 10, 18);
        pslist.add(ps1);
        Policy_Schedule__c ps2=ps.clone(false,true,false,false);
        ps2.VG_Is_MTA__c=True;
        ps2.VG_MTA_Type__c = 'Extension';
        ps2.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps2.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps2);
        Policy_Schedule__c ps3=ps1.clone(false,true,false,false); 
        ps3.VG_Is_MTA__c=True;
        ps3.VG_MTA_Type__c = 'Extension';
        ps3.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps3.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps3);
        Insert pslist;        
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);
        rr.VG_Sum_Insured__c = 4870;
        update rr;       
        VG_Policy_Schedule_Asset__c rr1=VG_TU.createPolicyScheduleAsset(ps1.id); 
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);        
        VG_Policy_Schedule_Endorsement__c pse2=VG_TU.createPolicyScheduleEndorsement(ps.id);        
        pse2.VG_Type__c = 'Sub-limits';
        update pse2;
        //Risk_Capture__c rc = VG_TU.createRiskCapture(ps.id);        
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        ApexPages.currentPage().getParameters().put('PSID', ps0.id);        
        MTAStepsController mta=new MTAStepsController();             
        mta.gotostep1();
        mta.seletedType='Cancellation';   
        mta.gotostep2();
        mta.MTAcancellationDate = ps0.VG_MTA_Cancellation_Date__c;
        mta.calcJunction();
        mta.gotoStep4();        
        mta.finish();  
        mta.Cancel();
        Utilities.clearMethods();  
        Test.stopTest(); 
        
    }
    
    public static testMethod void TestMethodAffinity1() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Utilities.SkipMethods('Trigger Context2'); 
        Policy__c pol=VG_TU.createPolicy('Affinity',acc.id);
        pol.VG_Inception_Date__c=Date.newInstance(2019, 12, 18);
        pol.VG_Expiry_Date__c=Date.newInstance(2020, 12, 18);
        update pol;
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id); 
        ps.VG_MTA_Type__c ='Revision of Cover';
        ps.VG_Is_MTA__c = true;
        ps.Technical_UW_Premium__c=7000;
        Ps.Premium_Adjustment__c=5000;
        ps.VG_Fee_Income__c=500;  
        ps.VG_MTA_Reduction_Date__c =Date.newInstance(2020, 5, 18);
        ps.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2019, 12, 19);
        ps.VG_MTA_Start_Date__c =Date.newInstance(2019, 12, 19);
        ps.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        update ps;
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);     
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);   
        Test.startTest();
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        MTAStepsController mta=new MTAStepsController();        
        mta.gotostep1();
        mta.gotostep2();
        mta.seletedType='Reduction';
        mta.gotostep2();
        mta.seletedType='Extension';
        mta.seletedProrateoption = 'Flat';
        mta.calcJunction();
        mta.seletedProrateoption = 'Prorated';
        mta.calcJunction();
        mta.finish();  
        pol.VG_Expiry_Date__c = ps.VG_MTA_End_Date__c;
        update pol;  
        mta.Cancel();
        Utilities.clearMethods();
        Test.stopTest();
    }

    public static testMethod void TestMethodAffinity2() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Test.startTest();        
        Utilities.SkipMethods('Bridge Context');       
        Policy__c pol=VG_TU.createPolicy('Affinity',acc.id);       
        List<Policy_Schedule__c> pslist = new List<Policy_Schedule__c>(); 
        Policy_Schedule__c ps0=VG_TU.createPolicySchedule(pol.id); 
        ps0.VG_MTA_Cancellation_Date__c=Date.newInstance(2018, 2, 1);
        ps0.VG_MTA_Reduction_Date__c =Date.newInstance(2018, 2, 1);
        ps0.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2018, 12, 19);        
        ps0.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps0.VG_MTA_Start_Date__c=Date.newInstance(2018, 12, 18);
        pslist.add(ps0); 
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id); 
        ps.Technical_UW_Premium__c=7000;
        ps.VG_Is_MTA__c = false;
        pslist.add(ps);               
        Policy_Schedule__c ps1=VG_TU.createPolicySchedule(pol.id); 
        ps1.VG_Is_MTA__c=True;
        ps1.VG_MTA_Type__c = 'Revision of Cover';
        ps1.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps1.VG_MTA_Start_Date__c=Date.newInstance(2018, 10, 18);
        pslist.add(ps1);
        Policy_Schedule__c ps2=VG_TU.createPolicySchedule(pol.id); 
        ps2.VG_Is_MTA__c=True;
        ps2.VG_MTA_Type__c = 'Extension';
        ps2.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps2.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps2);
        Policy_Schedule__c ps3=VG_TU.createPolicySchedule(pol.id); 
        ps3.VG_Is_MTA__c=True;
        ps3.VG_MTA_Type__c = 'Extension';
        ps3.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps3.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps3);
        update pslist;        
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id); 
        VG_Policy_Schedule_Asset__c rr1=VG_TU.createPolicyScheduleAsset(ps1.id); 
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);        
        VG_Policy_Schedule_Endorsement__c pse2=VG_TU.createPolicyScheduleEndorsement(ps.id);        
        pse2.VG_Type__c = 'Sub-limits';
        update pse2;
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        ApexPages.currentPage().getParameters().put('PSID', ps0.id);        
        MTAStepsController mta=new MTAStepsController();             
        mta.gotostep1();
        mta.seletedType='Cancellation';   
        mta.gotostep2();
        mta.MTAcancellationDate = ps0.VG_MTA_Cancellation_Date__c;
        mta.seletedProrateoption = 'Flat';
        mta.calcJunction();
        mta.seletedProrateoption = 'Prorated';
        mta.calcJunction();   
        mta.finish();  
        mta.Cancel();
        Utilities.clearMethods();
        Test.stopTest(); 
        
    }
    
    public static testMethod void TestMethodGentium1() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Utilities.SkipMethods('Trigger Context2');
        Policy__c pol=VG_TU.createPolicy('Gentium',acc.id);
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);   
        ps.Technical_UW_Premium__c=7000;
        Ps.Premium_Adjustment__c=5000;
        ps.VG_Fee_Income__c=500;  
        //ps.VG_MTA_Cancellation_Date__c =Date.newInstance(2019, 5, 18);
        ps.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2018, 12, 19);
        ps.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        update ps;
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);
        rr.VG_CH_Commission__c=1540;
        update rr;        
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);
		Test.startTest();      
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        MTAStepsController mta=new MTAStepsController();    
        MTAStepsController.PSWrapper psw = new MTAStepsController.PSWrapper();
        psw.CCAmount = 0;
        psw.CCPrecent = 0;
        PSW.TSI = 0;
        
        mta.gotostep1();
        mta.gotostep2();
        mta.seletedType='Extension';
        mta.seletedProrateoption = 'Flat';
        mta.gotostep2();
        mta.seletedProrateoption = 'Prorated';        
        mta.calcJunction();
        mta.finish();  
        pol.VG_Expiry_Date__c = ps.VG_MTA_End_Date__c;
        update pol;   
        mta.Cancel(); 
        Utilities.clearMethods();
        Test.stopTest();
    }
    
    public static testMethod void TestMethodGentium2() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('Gentium',acc.id);
        pol.VG_Inception_Date__c=Date.newInstance(2017, 12, 18);
        pol.VG_Expiry_Date__c =Date.newInstance(2019, 1, 18);
        update pol;                
		Test.startTest();
		Utilities.SkipMethods('Bridge Context');       
        List<Policy_Schedule__c> pslist = new List<Policy_Schedule__c>(); 
        Policy_Schedule__c ps0=VG_TU.createPolicySchedule(pol.id); 
        ps0.VG_MTA_Cancellation_Date__c=Date.newInstance(2018, 12, 19);
        ps0.VG_MTA_Reduction_Date__c =Date.newInstance(2018, 2, 1);
        ps0.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2018, 12, 19);        
        ps0.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps0.VG_MTA_Start_Date__c=Date.newInstance(2018, 12, 18);
        update ps0;
        Policy_Schedule__c ps=ps0.clone(false,true,false,false);
        ps.Technical_UW_Premium__c=7000;
        ps.VG_Is_MTA__c = false;
        pslist.add(ps);               
        Policy_Schedule__c ps1=ps.clone(false,true,false,false);
        ps1.VG_Is_MTA__c=True;
        ps1.VG_MTA_Type__c = 'Revision of Cover';
        ps1.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps1.VG_MTA_Start_Date__c=Date.newInstance(2018, 10, 18);
        pslist.add(ps1);
        Policy_Schedule__c ps2=ps.clone(false,true,false,false);
        ps2.VG_Is_MTA__c=True;
        ps2.VG_MTA_Type__c = 'Extension';
        ps2.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps2.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps2);
        Policy_Schedule__c ps3=ps1.clone(false,true,false,false);
        ps3.VG_Is_MTA__c=True;
        ps3.VG_MTA_Type__c = 'Extension';
        ps3.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps3.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps3);
        Insert pslist;        
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id); 
        Risk_Capture__c rc = VG_TU.createRiskCapture(ps.id);
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        ApexPages.currentPage().getParameters().put('PSID', ps0.id);        
        MTAStepsController mta=new MTAStepsController();             
        mta.gotostep1();
        mta.seletedType='Reduction';   
        mta.gotostep2();
        mta.MTAcancellationDate = ps0.VG_MTA_Reduction_Date__c;
        mta.calcJunction();
        mta.UpdateAdjustmentvalues();        
        mta.gotoStep4();        
        mta.finish();  
        mta.Cancel();
        MTAStepsController mta1=new MTAStepsController();             
        mta1.gotostep1();
        mta1.seletedType='Cancellation';   
        mta1.gotostep2();
        mta1.MTAcancellationDate = ps0.VG_MTA_Cancellation_Date__c;
        mta1.UpdateAdjustmentvalues();                
        mta1.calcJunction();
        mta1.gotoStep4();        
        mta1.finish();
        Test.stopTest();         
    }
   
    public static testMethod void TestMethodAesir1() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Utilities.SkipMethods('Trigger Context2');
        Policy__c pol=VG_TU.createPolicy('Aesir',acc.id);
        Test.startTest();        
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id); 
        ps.VG_MTA_Type__c ='Revision of Cover';
        ps.VG_Is_MTA__c = true;
        ps.Technical_UW_Premium__c=7000;
        Ps.Premium_Adjustment__c=5000;
        ps.VG_Fee_Income__c=500;  
        ps.VG_MTA_Reduction_Date__c =Date.newInstance(2020, 5, 18);
        ps.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2019, 12, 19);
        ps.VG_MTA_Start_Date__c =Date.newInstance(2019, 12, 19);
        ps.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        update ps;
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);    
        rr.Annual_Rate_100__c = 4800;
        update rr;
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);   
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        MTAStepsController mta=new MTAStepsController();        
        mta.gotostep1();
        mta.gotostep2();
        mta.seletedType='Reduction';
        mta.gotostep2();
        mta.seletedType='Extension';
        mta.seletedProrateoption = 'Flat';
        mta.UpdateAdjustmentvalues();
        mta.calcJunction();
        mta.seletedProrateoption = 'Prorated';
        mta.UpdateAdjustmentvalues();
        mta.calcJunction();
        mta.finish();  
        pol.VG_Expiry_Date__c = ps.VG_MTA_End_Date__c;
        update pol;  
        mta.Cancel();
        Utilities.clearMethods();
        Test.stopTest();
    }

    public static testMethod void TestMethodAesir2() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Utilities.SkipMethods('Bridge Context');
        Policy__c pol=VG_TU.createPolicy('Aesir',acc.id);
        Test.startTest();
        List<Policy_Schedule__c> pslist = new List<Policy_Schedule__c>(); 
        Policy_Schedule__c ps0=VG_TU.createPolicySchedule(pol.id); 
        ps0.VG_MTA_Cancellation_Date__c=Date.newInstance(2018, 2, 1);
        ps0.VG_MTA_Reduction_Date__c =Date.newInstance(2018, 2, 1);
        ps0.VG_Pre_MTA_Expiry_Date__c=Date.newInstance(2018, 12, 19);        
        ps0.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps0.VG_MTA_Start_Date__c=Date.newInstance(2018, 12, 18);
        ps0.Gross_or_Net_Premium__c = 'Net';
        ps0.Net_Premium__c =45;
        ps0.Share__c = 12;
        update ps0; 
        Policy_Schedule__c ps=ps0.clone(false,true,false,false); 
        ps.Technical_UW_Premium__c=7000;
        ps.VG_Is_MTA__c = false;
        pslist.add(ps);               
        Policy_Schedule__c ps1=ps.clone(false,true,false,false); 
        ps1.VG_Is_MTA__c=True;
        ps1.VG_MTA_Type__c = 'Revision of Cover';
        ps1.VG_MTA_End_Date__c=Date.newInstance(2019, 12, 18);
        ps1.VG_MTA_Start_Date__c=Date.newInstance(2018, 10, 18);
        pslist.add(ps1);
        Policy_Schedule__c ps2=ps.clone(false,true,false,false); 
        ps2.VG_Is_MTA__c=True;
        ps2.VG_MTA_Type__c = 'Extension';
        ps2.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps2.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps2);
        Policy_Schedule__c ps3=ps1.clone(false,true,false,false); 
        ps3.VG_Is_MTA__c=True;
        ps3.VG_MTA_Type__c = 'Extension';
        ps3.VG_MTA_End_Date__c=Date.newInstance(2020, 12, 18);
        ps3.VG_MTA_Start_Date__c=Date.newInstance(2019, 12, 19);
        pslist.add(ps3);
        Insert pslist;        
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id); 
        VG_Policy_Schedule_Asset__c rr1=VG_TU.createPolicyScheduleAsset(ps1.id);
        rr.Annual_Rate_100__c = 4800;
        update rr;
        rr1.Annual_Rate_100__c = 4800;
        update rr1;
        ApexPages.currentPage().getParameters().put('PId', pol.id);
        ApexPages.currentPage().getParameters().put('PSID', ps0.id);         
        MTAStepsController mta=new MTAStepsController();  
        mta.gotostep1();
        mta.seletedType='Cancellation';   
        mta.gotostep2();
        mta.MTAcancellationDate = ps0.VG_MTA_Cancellation_Date__c;
        mta.calcJunction();
        mta.finish();  
        mta.Cancel();
        Utilities.clearMethods();
        Test.stopTest(); 
        
    }
    
    public static testMethod void TestMethodBridgeROC() {
        VG_TU.policyCustomSetting();
        Account acc=VG_TU.createAccount('Customer');
        Policy__c pol=VG_TU.createPolicy('Bridge',acc.id);
        Policy_Schedule__c ps=VG_TU.createPolicySchedule(pol.id);
        ps.Technical_UW_Premium__c=5000;
        Ps.Levies__c =450;
        update ps;
        VG_Policy_Schedule_Asset__c rr=VG_TU.createPolicyScheduleAsset(ps.id);       
        Endorsement_Library__c EL1=VG_TU.createEndorsementLibraryCustom('Bridge','Sub-limits');        
        Endorsement_Library__c EL2=VG_TU.createEndorsementLibraryCustom('Bridge','Endorsements');       
        Endorsement_Library__c EL=VG_TU.createEndorsementLibrary();
        EL.RecordTypeId=Schema.SObjectType.Endorsement_Library__c.getRecordTypeInfosByName().get('Bridge').getRecordTypeId();
        EL.VG_Product__c='Property';        
        update EL;
        VG_Policy_Schedule_Endorsement__c pse=VG_TU.createPolicyScheduleEndorsement(ps.id);        
        ApexPages.currentPage().getParameters().put('PSID', ps.id);
        ApexPages.currentPage().getParameters().put('RecordType', 'Bridge');
        MTAStepsController.PSWrapper psw = new MTAStepsController.PSWrapper();
        MTAStepsController mta=new MTAStepsController();
        mta.gotostep1();
        mta.seletedType ='Revision of cover'; 
        mta.seletedProrateoption = 'Flat';
        mta.gotostep2();
        mta.seletedProrateoption = 'Prorated'; 
        mta.gotoStep4();          
        System.debug('ps.VG_MTA_End_Date__c::'+ps.VG_MTA_End_Date__c);
        ps.VG_MTA_Start_Date__c=Date.newInstance(2018, 12, 19);
        update ps;
        System.debug('ps.VG_MTA_End_Date__c::'+ps.VG_MTA_End_Date__c);
        mta.gotoStep4(); 
        mta.Cancel();
    }      
}